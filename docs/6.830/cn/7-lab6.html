<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>Lab 6 (Chinese) - everystep</title>


    <!-- Custom HTML head -->
    
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff" />

    <link rel="icon" href="../../favicon.svg">
    <link rel="shortcut icon" href="../../favicon.png">
    <link rel="stylesheet" href="../../css/variables.css">
    <link rel="stylesheet" href="../../css/general.css">
    <link rel="stylesheet" href="../../css/chrome.css">
    <link rel="stylesheet" href="../../css/print.css" media="print">

    <!-- Fonts -->
    <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
    <link rel="stylesheet" href="../../fonts/fonts.css">

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="../../highlight.css">
    <link rel="stylesheet" href="../../tomorrow-night.css">
    <link rel="stylesheet" href="../../ayu-highlight.css">

    <!-- Custom theme stylesheets -->
    <link rel="stylesheet" href="../../theme/style.css">


</head>
<body>
    <!-- Provide site root to javascript -->
    <script type="text/javascript">
        var path_to_root = "../../";
        var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
    </script>

    <!-- Work around some values being stored in localStorage wrapped in quotes -->
    <script type="text/javascript">
        try {
            var theme = localStorage.getItem('mdbook-theme');
            var sidebar = localStorage.getItem('mdbook-sidebar');
            if (theme.startsWith('"') && theme.endsWith('"')) {
                localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
            }
            if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) { }
    </script>

    <!-- Set the theme before any content is loaded, prevents flash -->
    <script type="text/javascript">
        var theme;
        try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
        if (theme === null || theme === undefined) { theme = default_theme; }
        var html = document.querySelector('html');
        html.classList.remove('no-js')
        html.classList.remove('light')
        html.classList.add(theme);
        html.classList.add('js');
    </script>

    <!-- Hide / unhide sidebar before it is displayed -->
    <script type="text/javascript">
        var html = document.querySelector('html');
        var sidebar = 'hidden';
        if (document.body.clientWidth >= 1080) {
            try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
            sidebar = sidebar || 'visible';
        }
        html.classList.remove('sidebar-visible');
        html.classList.add("sidebar-" + sidebar);
    </script>

    <nav id="sidebar" class="sidebar" aria-label="Table of contents">
        <div class="sidebar-scrollbox">
            <ol class="chapter"><li class="chapter-item affix "><a href="../../index.html">ç®€ä»‹</a></li><li class="chapter-item affix "><li class="part-title">ğŸ­ æ“ä½œç³»ç»Ÿ</li><li class="spacer"></li><li class="chapter-item "><a href="../../6.S081/0-summary.html"><strong aria-hidden="true">1.</strong> 6.S081</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../6.S081/1-lab1.html"><strong aria-hidden="true">1.1.</strong> Lab 1</a></li><li class="chapter-item "><a href="../../6.S081/2-lab2.html"><strong aria-hidden="true">1.2.</strong> Lab 2</a></li><li class="chapter-item "><a href="../../6.S081/3-lab3.html"><strong aria-hidden="true">1.3.</strong> Lab 3</a></li><li class="chapter-item "><a href="../../6.S081/4-lab4.html"><strong aria-hidden="true">1.4.</strong> Lab 4</a></li><li class="chapter-item "><a href="../../6.S081/5-lab5.html"><strong aria-hidden="true">1.5.</strong> Lab 5</a></li><li class="chapter-item "><a href="../../6.S081/6-lab6.html"><strong aria-hidden="true">1.6.</strong> Lab 6</a></li><li class="chapter-item "><a href="../../6.S081/7-lab7.html"><strong aria-hidden="true">1.7.</strong> Lab 7</a></li><li class="chapter-item "><a href="../../6.S081/8-lab8.html"><strong aria-hidden="true">1.8.</strong> Lab 8</a></li><li class="chapter-item "><a href="../../6.S081/9-lab9.html"><strong aria-hidden="true">1.9.</strong> Lab 9</a></li><li class="chapter-item "><a href="../../6.S081/10-lab10.html"><strong aria-hidden="true">1.10.</strong> Lab 10</a></li><li class="chapter-item "><a href="../../6.S081/11-lab11.html"><strong aria-hidden="true">1.11.</strong> Lab 11</a></li></ol></li><li class="chapter-item "><li class="part-title">ğŸš€ æ•°æ®åº“</li><li class="spacer"></li><li class="chapter-item "><a href="../../bitcask/index.html"><strong aria-hidden="true">2.</strong> ä»é›¶å®ç° BitCask å­˜å‚¨å¼•æ“</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.1.</strong> BitCask ç®€ä»‹</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.2.</strong> åˆ›å»º C++ é¡¹ç›®</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.3.</strong> æ•°æ®åœ¨å†…å­˜ä¸­</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.4.</strong> æ•°æ®åœ¨ç£ç›˜ä¸Š</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.5.</strong> BenchMark</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.6.</strong> å®ç°åˆå¹¶</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.7.</strong> å®ç°åƒåœ¾å›æ”¶</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.8.</strong> hintfile å®ç°</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.9.</strong> å“ˆå¸Œè¡¨ä¼˜åŒ–ä¸ºå¤šçº¿ç¨‹</a></li><li class="chapter-item "><a href="../../bitcask/ch1.html"><strong aria-hidden="true">2.10.</strong> æ•°æ®åœ¨ç£ç›˜ä¸Šå¦‚ä½•å­˜æ”¾ï¼Ÿ</a></li><li class="chapter-item "><a href="../../bitcask/ch2.html"><strong aria-hidden="true">2.11.</strong> å­˜å‚¨å¼•æ“çš„æ¥å£è®¾è®¡</a></li><li class="chapter-item "><a href="../../bitcask/ch3.html"><strong aria-hidden="true">2.12.</strong> å®ç° Setã€Get</a></li><li class="chapter-item "><a href="../../bitcask/ch4.html"><strong aria-hidden="true">2.13.</strong> åˆ é™¤é€»è¾‘å’Œ Compact </a></li></ol></li><li class="chapter-item "><a href="../../abyssdb/p0.html"><strong aria-hidden="true">3.</strong> ä»é›¶å®ç°å…³ç³»å‹æ•°æ®åº“</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../abyssdb/p1.html"><strong aria-hidden="true">3.1.</strong> ä» Table å¼€å§‹</a></li><li class="chapter-item "><a href="../../abyssdb/p2.html"><strong aria-hidden="true">3.2.</strong> Part 2. å®ç° Tuple</a></li><li class="chapter-item "><a href="../../abyssdb/p3.html"><strong aria-hidden="true">3.3.</strong> Part 3. å®ç° Page</a></li><li class="chapter-item "><a href="../../abyssdb/p4.html"><strong aria-hidden="true">3.4.</strong> Part 4. å®ç° HeapFile</a></li><li class="chapter-item "><a href="../../abyssdb/p5.html"><strong aria-hidden="true">3.5.</strong> Part 5. å®ç° BufferPool</a></li><li class="chapter-item "><a href="../../abyssdb/p6.html"><strong aria-hidden="true">3.6.</strong> Part 6. æ”¯æŒ int å’Œ string ç­‰æ•°æ®ç±»å‹ã€‚</a></li><li class="chapter-item "><a href="../../abyssdb/p7.html"><strong aria-hidden="true">3.7.</strong> Part 7. å®ç° Catalog</a></li></ol></li><li class="chapter-item expanded "><a href="../../6.830/1-lab0.html"><strong aria-hidden="true">4.</strong> 6.830</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../6.830/ans/2-lab1-ans.html"><strong aria-hidden="true">4.1.</strong> Lab 1 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/3-lab2-ans.html"><strong aria-hidden="true">4.2.</strong> Lab 2 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/4-lab3-ans.html"><strong aria-hidden="true">4.3.</strong> Lab 3 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/5-lab4-ans.html"><strong aria-hidden="true">4.4.</strong> Lab 4 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/6-lab5-ans.html"><strong aria-hidden="true">4.5.</strong> Lab 5 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/7-lab6-ans.html"><strong aria-hidden="true">4.6.</strong> Lab 6 Answers</a></li><li class="chapter-item "><a href="../../6.830/cn/2-lab1.html"><strong aria-hidden="true">4.7.</strong> Lab 1 (Chinese)</a></li><li class="chapter-item "><a href="../../6.830/cn/3-lab2.html"><strong aria-hidden="true">4.8.</strong> Lab 2 (Chinese)</a></li><li class="chapter-item "><a href="../../6.830/cn/4-lab3.html"><strong aria-hidden="true">4.9.</strong> Lab 3 (Chinese)</a></li><li class="chapter-item "><a href="../../6.830/cn/5-lab4.html"><strong aria-hidden="true">4.10.</strong> Lab 4 (Chinese)</a></li><li class="chapter-item "><a href="../../6.830/cn/6-lab5.html"><strong aria-hidden="true">4.11.</strong> Lab 5 (Chinese)</a></li><li class="chapter-item expanded "><a href="../../6.830/cn/7-lab6.html" class="active"><strong aria-hidden="true">4.12.</strong> Lab 6 (Chinese)</a></li></ol></li><li class="chapter-item "><li class="part-title">ğŸ§Š åˆ†å¸ƒå¼</li><li class="spacer"></li><li class="chapter-item "><a href="../../6.824/0-lab0.html"><strong aria-hidden="true">5.</strong> 6.824</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../6.824/1-lab1-cn.html"><strong aria-hidden="true">5.1.</strong> Lab 1 (Chinese)</a></li><li class="chapter-item "><a href="../../6.824/1-lab1.html"><strong aria-hidden="true">5.2.</strong> Lab 1</a></li><li class="chapter-item "><a href="../../6.824/2-lab2-cn.html"><strong aria-hidden="true">5.3.</strong> Lab 2 (Chinese)</a></li><li class="chapter-item "><a href="../../6.824/2-lab2.html"><strong aria-hidden="true">5.4.</strong> Lab 2</a></li></ol></li><li class="chapter-item "><li class="part-title">ğŸ”¥ å…¶ä»–</li><li class="spacer"></li><li class="chapter-item "><a href="../../6.828/0-sum.html"><strong aria-hidden="true">6.</strong> 6.828</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../6.828/1-env.html"><strong aria-hidden="true">6.1.</strong> Environment Setup</a></li><li class="chapter-item "><a href="../../6.828/1-part1.html"><strong aria-hidden="true">6.2.</strong> Part 1</a></li></ol></li><li class="chapter-item "><a href="../../review/1_go.html"><strong aria-hidden="true">7.</strong> å…«è‚¡</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../review/2_cpp.html"><strong aria-hidden="true">7.1.</strong> C++</a></li><li class="chapter-item "><a href="../../review/3_cn.html"><strong aria-hidden="true">7.2.</strong> Computer Networks</a></li></ol></li><li class="chapter-item "><a href="../../lsm/index.html"><strong aria-hidden="true">8.</strong> ä»é›¶å®ç° LSM-Tree å­˜å‚¨å¼•æ“</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../lsm/ch1.html"><strong aria-hidden="true">8.1.</strong> Part 1</a></li><li class="chapter-item "><a href="../../lsm/ch2.html"><strong aria-hidden="true">8.2.</strong> Part 2</a></li><li class="chapter-item "><a href="../../lsm/ch3.html"><strong aria-hidden="true">8.3.</strong> Part 3</a></li><li class="chapter-item "><a href="../../lsm/ch4.html"><strong aria-hidden="true">8.4.</strong> Part 4</a></li></ol></li></ol>
        </div>
        <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
    </nav>

    <div id="page-wrapper" class="page-wrapper">

        <div class="page">
                        <div id="menu-bar-hover-placeholder"></div>
            <div id="menu-bar" class="menu-bar sticky bordered">
                <div class="left-buttons">
                    <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                        <i class="fa fa-bars"></i>
                    </button>
                    <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                        <i class="fa fa-paint-brush"></i>
                    </button>
                    <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                        <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                    </ul>
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
                </div>

                <h1 class="menu-title">everystep</h1>

                <div class="right-buttons">
                    <a href="../../print.html" title="Print this book" aria-label="Print this book">
                        <i id="print-button" class="fa fa-print"></i>
                    </a>
                    <a href="https://github.com/weijiew/everystep" title="Git repository" aria-label="Git repository">
                        <i id="git-repository-button" class="fa fa-github"></i>
                    </a>
                    <a href="https://github.com/weijiew/everystep/edit/master/src/6.830/cn/7-lab6.md" title="Suggest an edit" aria-label="Suggest an edit">
                        <i id="git-edit-button" class="fa fa-edit"></i>
                    </a>

                </div>
            </div>

            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>

            <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
            <script type="text/javascript">
                document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');

                // Get viewed page store
                var viewed_key = 'mdbook-viewed';
                var viewed_map = {};
                try {
                    var viewed_storage = localStorage.getItem(viewed_key);
                    if (viewed_storage) {
                        viewed_map = JSON.parse(viewed_storage)
                    }
                } catch (e) { }

                Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                    link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);

                    // Apply viewed style
                    if (viewed_map[link.pathname]) {
                        link.classList.add('md-viewed')
                    }
                }); 

                // Mark viewed after 30s
                setTimeout(function() {
                    viewed_map[location.pathname] = 1;
                    localStorage.setItem(viewed_key, JSON.stringify(viewed_map));
                }, 30000)
            </script>

            <div id="content" class="content">
                <!-- Page table of contents -->
                <div class="sidetoc"><nav class="pagetoc"></nav></div>
                <main>
                    <h1 id="lab-6-ç¿»è¯‘"><a class="header" href="#lab-6-ç¿»è¯‘">Lab 6 ç¿»è¯‘</a></h1>
<p>Assigned: Monday, May 3, 2021
Due: Wednesday, May 19, 2021 11:59 PM EST</p>
<h2 id="0-introduction"><a class="header" href="#0-introduction">0. Introduction</a></h2>
<p>In this lab you will implement log-based rollback for aborts and log-based crash recovery. We supply you with the code that defines the log format and appends records to a log file at appropriate times during transactions. You will implement rollback and recovery using the contents of the log file.</p>
<p>åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½ å°†å®ç°åŸºäºæ—¥å¿—çš„ä¸­æ­¢å›æ»šå’ŒåŸºäºæ—¥å¿—çš„å´©æºƒæ¢å¤ã€‚æˆ‘ä»¬ä¸ºä½ æä¾›äº†å®šä¹‰æ—¥å¿—æ ¼å¼çš„ä»£ç ï¼Œå¹¶åœ¨äº¤æ˜“è¿‡ç¨‹ä¸­çš„é€‚å½“æ—¶å€™å°†è®°å½•é™„åŠ åˆ°æ—¥å¿—æ–‡ä»¶ä¸­ã€‚ä½ å°†ä½¿ç”¨æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å®ç°å›æ»šå’Œæ¢å¤ã€‚</p>
<p>The logging code we provide generates records intended for physical whole-page undo and redo. When a page is first read in, our code remembers the original content of the page as a before-image. When a transaction updates a page, the corresponding log record contains that remembered before-image as well as the content of the page after modification as an after-image. You'll use the before-image to roll back during aborts and to undo loser transactions during recovery, and the after-image to redo winners during recovery.</p>
<p>æˆ‘ä»¬æä¾›çš„æ—¥å¿—ä»£ç äº§ç”Ÿçš„è®°å½•æ—¨åœ¨ç”¨äºç‰©ç†çš„æ•´é¡µæ’¤é”€å’Œé‡åšã€‚å½“ä¸€ä¸ªé¡µé¢ç¬¬ä¸€æ¬¡è¢«è¯»å…¥æ—¶ï¼Œæˆ‘ä»¬çš„ä»£ç ä¼šè®°ä½è¯¥é¡µé¢çš„åŸå§‹å†…å®¹ï¼Œä½œä¸ºä¸€ä¸ªä¹‹å‰çš„å›¾åƒã€‚å½“ä¸€ä¸ªäº‹åŠ¡æ›´æ–°ä¸€ä¸ªé¡µé¢æ—¶ï¼Œç›¸åº”çš„æ—¥å¿—è®°å½•åŒ…å«è®°å¿†ä¸­çš„before-imageä»¥åŠä¿®æ”¹åçš„é¡µé¢å†…å®¹ä½œä¸ºafter-imageã€‚ä½ å°†ä½¿ç”¨before-imageåœ¨ä¸­æ­¢è¿‡ç¨‹ä¸­å›æ»šï¼Œå¹¶åœ¨æ¢å¤è¿‡ç¨‹ä¸­æ’¤é”€å¤±è´¥çš„äº‹åŠ¡ï¼Œè€Œafter-imageåˆ™åœ¨æ¢å¤è¿‡ç¨‹ä¸­é‡åšèƒœåˆ©è€…ã€‚</p>
<p>We are able to get away with doing whole-page physical UNDO (while ARIES must do logical UNDO) because we are doing page level locking and because we have no indices which may have a different structure at UNDO time than when the log was initially written. The reason page-level locking simplifies things is that if a transaction modified a page, it must have had an exclusive lock on it, which means no other transaction was concurrently modifying it, so we can UNDO changes to it by just overwriting the whole page.</p>
<p>æˆ‘ä»¬èƒ½å¤Ÿæ‘†è„±åšæ•´ä¸ªé¡µé¢çš„ç‰©ç†UNDOï¼ˆè€ŒARIESå¿…é¡»åšé€»è¾‘UNDOï¼‰ï¼Œå› ä¸ºæˆ‘ä»¬åšçš„æ˜¯é¡µçº§é”ï¼Œè€Œä¸”æˆ‘ä»¬æ²¡æœ‰ç´¢å¼•ï¼Œåœ¨UNDOæ—¶çš„ç»“æ„å¯èƒ½ä¸æœ€åˆå†™æ—¥å¿—æ—¶ä¸åŒã€‚é¡µçº§é”ç®€åŒ–äº†äº‹æƒ…çš„åŸå› æ˜¯ï¼Œå¦‚æœä¸€ä¸ªäº‹åŠ¡ä¿®æ”¹äº†ä¸€ä¸ªé¡µé¢ï¼Œå®ƒä¸€å®šæœ‰ä¸€ä¸ªç‹¬å é”ï¼Œè¿™æ„å‘³ç€æ²¡æœ‰å…¶ä»–äº‹åŠ¡åœ¨åŒæ—¶ä¿®æ”¹å®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è¦†ç›–æ•´ä¸ªé¡µé¢æ¥UNDOå¯¹å®ƒçš„ä¿®æ”¹ã€‚</p>
<p>Your BufferPool already implements abort by deleting dirty pages, and pretends to implement atomic commit by forcing dirty pages to disk only at commit time. Logging allows more flexible buffer management (STEAL and NO-FORCE), and our test code calls BufferPool.flushAllPages() at certain points in order to exercise that flexibility.</p>
<p>ä½ çš„BufferPoolå·²ç»é€šè¿‡åˆ é™¤è„é¡µå®ç°äº†ä¸­æ­¢ï¼Œå¹¶é€šè¿‡åœ¨æäº¤æ—¶å¼ºåˆ¶è„é¡µåˆ°ç£ç›˜æ¥å‡è£…å®ç°åŸå­æäº¤ã€‚æ—¥å¿—å…è®¸æ›´çµæ´»çš„ç¼“å†²åŒºç®¡ç†ï¼ˆSTEALå’ŒNO-FORCEï¼‰ï¼Œæˆ‘ä»¬çš„æµ‹è¯•ä»£ç åœ¨æŸäº›åœ°æ–¹è°ƒç”¨BufferPool.flushAllPages()ï¼Œä»¥è¡Œä½¿è¿™ç§çµæ´»æ€§ã€‚</p>
<h2 id="1-getting-started"><a class="header" href="#1-getting-started">1. Getting started</a></h2>
<p>You should begin with the code you submitted for Lab 5 (if you did not submit code for Lab 5, or your solution didn't work properly, contact us to discuss options.)</p>
<p>ä½ åº”è¯¥ä»ä½ ä¸ºå®éªŒ5æäº¤çš„ä»£ç å¼€å§‹ï¼ˆå¦‚æœä½ æ²¡æœ‰ä¸ºå®éªŒ5æäº¤ä»£ç ï¼Œæˆ–è€…ä½ çš„è§£å†³æ–¹æ¡ˆæ²¡æœ‰æ­£å¸¸å·¥ä½œï¼Œè¯·ä¸æˆ‘ä»¬è”ç³»ï¼Œè®¨è®ºå„ç§æ–¹æ¡ˆï¼‰ã€‚</p>
<p>You'll need to modify some of your existing source and add a few new files. Here's what to do:</p>
<p>ä½ éœ€è¦ä¿®æ”¹ä¸€äº›ç°æœ‰çš„æºä»£ç å¹¶æ·»åŠ ä¸€äº›æ–°çš„æ–‡ä»¶ã€‚ä¸‹é¢æ˜¯è¦åšçš„äº‹æƒ…ã€‚</p>
<p>First change to your project directory (probably called simple-db-hw) and pull from the master GitHub repository:</p>
<p>é¦–å…ˆåˆ‡æ¢åˆ°ä½ çš„é¡¹ç›®ç›®å½•ï¼ˆå¯èƒ½å«simple-db-hwï¼‰ï¼Œå¹¶ä»GitHubä¸»ä»“åº“æ‹‰å–ã€‚</p>
<pre><code>$ cd simple-db-hw
$ git pull upstream master
</code></pre>
<p>Now make the following changes to your existing code:</p>
<p>ç°åœ¨å¯¹ä½ ç°æœ‰çš„ä»£ç åšå¦‚ä¸‹ä¿®æ”¹ã€‚</p>
<p>Insert the following lines into BufferPool.flushPage() before your call to writePage(p), where p is a reference to the page being written:</p>
<p>åœ¨è°ƒç”¨writePage(p)ä¹‹å‰ï¼Œåœ¨BufferPool.flushPage()ä¸­æ’å…¥ä»¥ä¸‹å‡ è¡Œï¼Œå…¶ä¸­pæ˜¯å¯¹è¢«å†™å…¥é¡µé¢çš„å¼•ç”¨ã€‚</p>
<pre><code>// append an update record to the log, with 
// a before-image and after-image.
TransactionId dirtier = p.isDirty();
if (dirtier != null){
  Database.getLogFile().logWrite(dirtier, p.getBeforeImage(), p);
  Database.getLogFile().force();
}
</code></pre>
<p>This causes the logging system to write an update to the log.
We force the log to ensure the log record is on disk before the page is written to disk.</p>
<p>è¿™å°†å¯¼è‡´æ—¥å¿—ç³»ç»Ÿå‘æ—¥å¿—å†™å…¥æ›´æ–°ã€‚
æˆ‘ä»¬å¼ºè¿«æ—¥å¿—åœ¨é¡µé¢è¢«å†™å…¥ç£ç›˜ä¹‹å‰ç¡®ä¿æ—¥å¿—è®°å½•åœ¨ç£ç›˜ä¸Šã€‚</p>
<p>Your BufferPool.transactionComplete() calls flushPage() for each page that a committed transaction dirtied. For each such page, add a call to p.setBeforeImage() after you have flushed the page:</p>
<p>ä½ çš„BufferPool.transactionComplete()ä¸ºæ¯ä¸€ä¸ªè¢«æäº¤çš„äº‹åŠ¡æ…ä¹±çš„é¡µé¢è°ƒç”¨flushPage()ã€‚å¯¹äºæ¯ä¸€ä¸ªè¿™æ ·çš„é¡µé¢ï¼Œåœ¨ä½ åˆ·æ–°é¡µé¢ä¹‹åï¼Œæ·»åŠ ä¸€ä¸ªå¯¹p.setBeforeImage()çš„è°ƒç”¨ã€‚</p>
<pre><code>// use current page contents as the before-image
// for the next transaction that modifies this page.
p.setBeforeImage();
</code></pre>
<p>After an update is committed, a page's before-image needs to be updated so that later transactions that abort rollback to this committed version of the page. (Note: We can't just call setBeforeImage() in flushPage(), since flushPage() might be called even if a transaction isn't committing. Our test case actually does that! If you implemented transactionComplete() by calling flushPages() instead, you may need to pass an additional argument to flushPages() to tell it whether the flush is being done for a committing transaction or not. However, we strongly suggest
in this case you simply rewrite transactionComplete() to use flushPage().)
After you have made these changes, do a clean build (ant clean; ant from the command line, or a &quot;Clean&quot; from the &quot;Project&quot; menu in Eclipse.)</p>
<p>åœ¨ä¸€ä¸ªæ›´æ–°è¢«æäº¤åï¼Œä¸€ä¸ªé¡µé¢çš„before-imageéœ€è¦è¢«æ›´æ–°ï¼Œä»¥ä¾¿åæ¥çš„äº‹åŠ¡ä¸­æ­¢æ—¶å›æ»šåˆ°è¯¥é¡µé¢çš„è¿™ä¸ªæäº¤ç‰ˆæœ¬ã€‚(æ³¨æ„ï¼šæˆ‘ä»¬ä¸èƒ½åœ¨flushPage()ä¸­ç›´æ¥è°ƒç”¨setBeforeImage()ï¼Œå› ä¸ºå³ä½¿äº‹åŠ¡æ²¡æœ‰æäº¤ï¼ŒflushPage()ä¹Ÿå¯èƒ½è¢«è°ƒç”¨ã€‚æˆ‘ä»¬çš„æµ‹è¯•æ¡ˆä¾‹å®é™…ä¸Šå°±æ˜¯è¿™æ ·åšçš„! å¦‚æœä½ é€šè¿‡è°ƒç”¨flushPages()æ¥å®ç°transactionComplete()ï¼Œä½ å¯èƒ½éœ€è¦ç»™flushPages()ä¼ é€’ä¸€ä¸ªé¢å¤–çš„å‚æ•°ï¼Œå‘Šè¯‰å®ƒæ˜¯å¦ä¸ºä¸€ä¸ªæ­£åœ¨æäº¤çš„äº‹åŠ¡è¿›è¡Œåˆ·æ–°ã€‚ç„¶è€Œï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®ä½ ç®€å•åœ°é‡å†™ transactionComplete() ä»¥ä½¿ç”¨ flushPage()ã€‚ åœ¨ä½ åšäº†è¿™äº›ä¿®æ”¹ä¹‹åï¼Œåšä¸€ä¸ªå¹²å‡€çš„æ„å»ºï¼ˆant clean; ant from the command line, or a &quot;Clean&quot; from the &quot;Project&quot; menu in Eclipse.ï¼‰</p>
<p>At this point your code should pass the first three sub-tests of the LogTest systemtest, and fail the rest:</p>
<p>åœ¨è¿™ä¸€ç‚¹ä¸Šï¼Œä½ çš„ä»£ç åº”è¯¥é€šè¿‡LogTestç³»ç»Ÿæµ‹è¯•çš„å‰ä¸‰ä¸ªå­æµ‹è¯•ï¼Œè€Œå…¶ä½™çš„åˆ™å¤±è´¥ã€‚</p>
<pre><code>% ant runsystest -Dtest=LogTest
...
[junit] Running simpledb.systemtest.LogTest
[junit] Testsuite: simpledb.systemtest.LogTest
[junit] Tests run: 10, Failures: 0, Errors: 7, Time elapsed: 0.42 sec
[junit] Tests run: 10, Failures: 0, Errors: 7, Time elapsed: 0.42 sec
[junit] 
[junit] Testcase: PatchTest took 0.057 sec
[junit] Testcase: TestFlushAll took 0.022 sec
[junit] Testcase: TestCommitCrash took 0.018 sec
[junit] Testcase: TestAbort took 0.03 sec
[junit]     Caused an ERROR
[junit] LogTest: tuple present but shouldn't be
...
</code></pre>
<p>If you don't see the above output from ant runsystest -Dtest=LogTest, something has gone wrong with pulling the new files, or the changes you made are somehow incompatible with your existing code. You should figure out and fix the problem before proceeding; ask us for help if necessary.</p>
<p>å¦‚æœä½ åœ¨ant runsystest -Dtest=LogTestä¸­æ²¡æœ‰çœ‹åˆ°ä¸Šè¿°è¾“å‡ºï¼Œè¯´æ˜åœ¨æ‹‰å–æ–°æ–‡ä»¶æ—¶å‡ºäº†é—®é¢˜ï¼Œæˆ–è€…ä½ æ‰€åšçš„ä¿®æ”¹ä¸ä½ ç°æœ‰çš„ä»£ç æœ‰æŸç§ä¸å…¼å®¹ã€‚ä½ åº”è¯¥åœ¨ç»§ç»­è¿›è¡Œä¹‹å‰æ‰¾å‡ºå¹¶è§£å†³è¿™ä¸ªé—®é¢˜ï¼›å¦‚æœæœ‰å¿…è¦ï¼Œè¯·å‘æˆ‘ä»¬å¯»æ±‚å¸®åŠ©ã€‚</p>
<h2 id="2-rollback"><a class="header" href="#2-rollback">2. Rollback</a></h2>
<p>Read the comments in LogFile.java for a description of the log file format. You should see in LogFile.java a set of functions, such as logCommit(), that generate each kind of log record and append it to the log.</p>
<p>é˜…è¯»LogFile.javaä¸­çš„æ³¨é‡Šï¼Œä»¥äº†è§£å¯¹æ—¥å¿—æ–‡ä»¶æ ¼å¼çš„æè¿°ã€‚ä½ åº”è¯¥åœ¨LogFile.javaä¸­çœ‹åˆ°ä¸€ç»„å‡½æ•°ï¼Œæ¯”å¦‚logCommit()ï¼Œå®ƒä»¬ç”Ÿæˆæ¯ä¸€ç§æ—¥å¿—è®°å½•å¹¶å°†å…¶è¿½åŠ åˆ°æ—¥å¿—ä¸­ã€‚</p>
<p>Your first job is to implement the rollback() function in LogFile.java. This function is called when a transaction aborts, before the transaction releases its locks. Its job is to un-do any changes the transaction may have made to the database.</p>
<p>ä½ çš„ç¬¬ä¸€é¡¹å·¥ä½œæ˜¯å®ç°LogFile.javaä¸­çš„rollback()å‡½æ•°ã€‚å½“ä¸€ä¸ªäº‹åŠ¡ä¸­æ­¢æ—¶ï¼Œåœ¨è¯¥äº‹åŠ¡é‡Šæ”¾å…¶é”ä¹‹å‰ï¼Œè¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨ã€‚å®ƒçš„å·¥ä½œæ˜¯è§£é™¤äº‹åŠ¡å¯èƒ½å¯¹æ•°æ®åº“åšå‡ºçš„ä»»ä½•æ”¹å˜ã€‚</p>
<p>Your rollback() should read the log file, find all update records associated with the aborting transaction, extract the before-image from each, and write the before-image to the table file. Use raf.seek() to move around in the log file, and raf.readInt() etc. to examine it. Use readPageData() to read each of the before- and after-images. You can use the map tidToFirstLogRecord (which maps from a transaction id to an offset in the heap file) to determine where to start reading the log file for a particular transaction. You will need to make sure that you discard any page from the buffer pool whose before-image you write back to the table file.</p>
<p>ä½ çš„å›æ»š()åº”è¯¥è¯»å–æ—¥å¿—æ–‡ä»¶ï¼Œæ‰¾åˆ°æ‰€æœ‰ä¸ä¸­æ­¢äº‹åŠ¡ç›¸å…³çš„æ›´æ–°è®°å½•ï¼Œä»æ¯ä¸ªè®°å½•ä¸­æå–ä¹‹å‰çš„å›¾åƒï¼Œå¹¶å°†ä¹‹å‰çš„å›¾åƒå†™åˆ°è¡¨æ–‡ä»¶ä¸­ã€‚ä½¿ç”¨raf.seek()åœ¨æ—¥å¿—æ–‡ä»¶ä¸­ç§»åŠ¨ï¼Œä½¿ç”¨raf.readInt()ç­‰æ¥æ£€æŸ¥å®ƒã€‚ä½¿ç”¨readPageData()æ¥è¯»å–æ¯å¼ å‰åçš„å›¾åƒã€‚ä½ å¯ä»¥ä½¿ç”¨map tidToFirstLogRecordï¼ˆå®ƒä»äº¤æ˜“IDæ˜ å°„åˆ°å †æ–‡ä»¶ä¸­çš„åç§»é‡ï¼‰æ¥ç¡®å®šä»å“ªé‡Œå¼€å§‹è¯»å–ç‰¹å®šäº¤æ˜“çš„æ—¥å¿—æ–‡ä»¶ã€‚ä½ éœ€è¦ç¡®ä¿ä»ç¼“å†²æ± ä¸­ä¸¢å¼ƒä»»ä½•ä½ å†™å›è¡¨æ–‡ä»¶çš„å‰å›¾åƒçš„é¡µé¢ã€‚</p>
<p>As you develop your code, you may find the Logfile.print() method useful for displaying the current contents of the log.</p>
<p>å½“ä½ å¼€å‘ä½ çš„ä»£ç æ—¶ï¼Œä½ å¯èƒ½ä¼šå‘ç°Logfile.print()æ–¹æ³•å¯¹äºæ˜¾ç¤ºæ—¥å¿—çš„å½“å‰å†…å®¹å¾ˆæœ‰ç”¨ã€‚</p>
<h2 id="exercise-1-logfilerollback"><a class="header" href="#exercise-1-logfilerollback">Exercise 1: LogFile.rollback()</a></h2>
<p>Implement LogFile.rollback().</p>
<p>After completing this exercise, you should be able to pass the TestAbort and TestAbortCommitInterleaved sub-tests of the LogTest system test.</p>
<p>å®Œæˆè¿™ä¸ªç»ƒä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿé€šè¿‡LogTestç³»ç»Ÿæµ‹è¯•çš„TestAbortå’ŒTestAbortCommitInterleavedå­æµ‹è¯•ã€‚</p>
<h2 id="3-recovery"><a class="header" href="#3-recovery">3. Recovery</a></h2>
<p>If the database crashes and then reboots, LogFile.recover() will be called before any new transactions start. Your implementation should:</p>
<p>å¦‚æœæ•°æ®åº“å´©æºƒï¼Œç„¶åé‡æ–°å¯åŠ¨ï¼ŒLogFile.recover()å°†åœ¨ä»»ä½•æ–°äº‹åŠ¡å¼€å§‹ä¹‹å‰è¢«è°ƒç”¨ã€‚ä½ çš„å®ç°åº”è¯¥ã€‚</p>
<p>Read the last checkpoint, if any.</p>
<p>è¯»å–æœ€åä¸€ä¸ªæ£€æŸ¥ç‚¹ï¼Œå¦‚æœæœ‰çš„è¯ã€‚</p>
<p>Scan forward from the checkpoint (or start of log file, if no checkpoint) to build the set of loser transactions. Re-do updates during this pass. You can safely start re-do at the checkpoint because LogFile.logCheckpoint() flushes all dirty buffers to disk.</p>
<p>ä»æ£€æŸ¥ç‚¹ï¼ˆå¦‚æœæ²¡æœ‰æ£€æŸ¥ç‚¹ï¼Œåˆ™ä»æ—¥å¿—æ–‡ä»¶å¼€å§‹ï¼‰å‘å‰æ‰«æï¼Œä»¥å»ºç«‹å¤±è´¥çš„äº‹åŠ¡é›†ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­è¿›è¡Œé‡åšæ›´æ–°ã€‚ä½ å¯ä»¥å®‰å…¨åœ°åœ¨æ£€æŸ¥ç‚¹å¼€å§‹é‡åšï¼Œå› ä¸ºLogFile.logCheckpoint()ä¼šå°†æ‰€æœ‰çš„è„ç¼“å†²åŒºåˆ·åˆ°ç£ç›˜ä¸Šã€‚</p>
<p>Un-do the updates of loser transactions.</p>
<p>å–æ¶ˆå¯¹å¤±è´¥è€…äº¤æ˜“çš„æ›´æ–°ã€‚</p>
<h2 id="exercise-2-logfilerecover"><a class="header" href="#exercise-2-logfilerecover">Exercise 2: LogFile.recover()</a></h2>
<p>Implement LogFile.recover().</p>
<p>After completing this exercise, you should be able to pass all of the LogTest system test.</p>
<p>å®Œæˆè¿™ä¸ªç»ƒä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿé€šè¿‡æ‰€æœ‰çš„LogTestç³»ç»Ÿæµ‹è¯•ã€‚</p>
<h2 id="4-logistics"><a class="header" href="#4-logistics">4. Logistics</a></h2>
<p>You must submit your code (see below) as well as a short (1 page, maximum) writeup describing your approach. This writeup should:</p>
<p>ä½ å¿…é¡»æäº¤ä½ çš„ä»£ç ï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œä»¥åŠæè¿°ä½ çš„æ–¹æ³•çš„ç®€çŸ­ï¼ˆæœ€å¤š1é¡µï¼‰çš„æ–‡ç« ã€‚è¿™ç¯‡æŠ¥å‘Šåº”è¯¥</p>
<p>Describe any design decisions you made, including anything that was difficult or unexpected.</p>
<p>æè¿°ä½ æ‰€åšçš„ä»»ä½•è®¾è®¡å†³å®šï¼ŒåŒ…æ‹¬ä»»ä½•å›°éš¾æˆ–æ„å¤–ã€‚</p>
<p>Discuss and justify any changes you made outside of LogFile.java.</p>
<p>è®¨è®ºå¹¶è®ºè¯ä½ åœ¨LogFile.javaä¹‹å¤–æ‰€åšçš„ä»»ä½•æ”¹åŠ¨ã€‚</p>
<h2 id="41-collaboration"><a class="header" href="#41-collaboration">4.1. Collaboration</a></h2>
<p>This lab should be manageable for a single person, but if you prefer to work with a partner, this is also OK. Larger groups are not allowed. Please indicate clearly who you worked with, if anyone, on your writeup.</p>
<p>è¿™ä¸ªå®éªŒå¯¹ä¸€ä¸ªäººæ¥è¯´åº”è¯¥æ˜¯å¯ä»¥åº”ä»˜çš„ï¼Œä½†å¦‚æœä½ å–œæ¬¢å’Œä¸€ä¸ªä¼™ä¼´ä¸€èµ·å·¥ä½œï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¸å…è®¸æœ‰è¾ƒå¤§çš„å›¢ä½“ã€‚å¦‚æœæœ‰çš„è¯ï¼Œè¯·åœ¨ä½ çš„æŠ¥å‘Šä¸­æ˜ç¡®æŒ‡å‡ºä½ å’Œè°ä¸€èµ·å·¥ä½œã€‚</p>
<h2 id="42-submitting-your-assignment"><a class="header" href="#42-submitting-your-assignment">4.2. Submitting your assignment</a></h2>
<p>We will be using gradescope to autograde all programming assignments. You should have all been invited to the class instance; if not, please let us know and we can help you set up. You may submit your code multiple times before the deadline; we will use the latest version as determined by gradescope. Place the write-up in a file called lab3-writeup.txt with your submission. You also need to explicitly add any other files you create, such as new *.java files.</p>
<p>æˆ‘ä»¬å°†ä½¿ç”¨gradescopeå¯¹æ‰€æœ‰ç¼–ç¨‹ä½œä¸šè¿›è¡Œè‡ªåŠ¨è¯„åˆ†ã€‚ä½ ä»¬åº”è¯¥éƒ½è¢«é‚€è¯·åˆ°ç­çº§å®ä¾‹ä¸­ï¼›å¦‚æœæ²¡æœ‰ï¼Œè¯·å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¯ä»¥å¸®åŠ©ä½ ä»¬è®¾ç½®ã€‚ä½ å¯ä»¥åœ¨æˆªæ­¢æ—¥æœŸå‰å¤šæ¬¡æäº¤ä½ çš„ä»£ç ï¼›æˆ‘ä»¬å°†ä½¿ç”¨ç”±gradescopeç¡®å®šçš„æœ€æ–°ç‰ˆæœ¬ã€‚æŠŠå†™å¥½çš„ä¸œè¥¿æ”¾åœ¨ä¸€ä¸ªå«lab3-writeup.txtçš„æ–‡ä»¶é‡Œï¼Œå’Œä½ çš„æäº¤ä¸€èµ·ã€‚ä½ è¿˜éœ€è¦æ˜ç¡®åœ°æ·»åŠ ä½ åˆ›å»ºçš„ä»»ä½•å…¶ä»–æ–‡ä»¶ï¼Œå¦‚æ–°çš„*.javaæ–‡ä»¶ã€‚</p>
<p>The easiest way to submit to gradescope is with .zip files containing your code. On Linux/MacOS, you can do so by running the following command:</p>
<p>å‘ gradescope æäº¤çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨åŒ…å«ä½ çš„ä»£ç çš„ .zip æ–‡ä»¶ã€‚åœ¨Linux/MacOSä¸Šï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®ç°ã€‚</p>
<pre><code>$ zip -r submission.zip src/ lab6-writeup.txt
</code></pre>
<h2 id="43-submitting-a-bug"><a class="header" href="#43-submitting-a-bug">4.3. Submitting a bug</a></h2>
<p>SimpleDB is a relatively complex piece of code. It is very possible you are going to find bugs, inconsistencies, and bad, outdated, or incorrect documentation, etc.</p>
<p>SimpleDBæ˜¯ä¸€ä¸ªç›¸å¯¹å¤æ‚çš„ä»£ç ã€‚ä½ å¾ˆå¯èƒ½ä¼šå‘ç°é”™è¯¯ã€ä¸ä¸€è‡´ï¼Œä»¥åŠç³Ÿç³•çš„ã€è¿‡æ—¶çš„æˆ–ä¸æ­£ç¡®çš„æ–‡æ¡£ç­‰ç­‰ã€‚</p>
<p>We ask you, therefore, to do this lab with an adventurous mindset. Don't get mad if something is not clear, or even wrong; rather, try to figure it out yourself or send us a friendly email. Please submit (friendly!) bug reports to 6.830-staff@mit.edu. When you do, please try to include:</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬è¦æ±‚ä½ ä»¥ä¸€ç§å†’é™©çš„å¿ƒæ€æ¥åšè¿™ä¸ªå®éªŒã€‚å¦‚æœæœ‰ä¸æ¸…æ¥šçš„åœ°æ–¹ï¼Œç”šè‡³æ˜¯é”™è¯¯çš„åœ°æ–¹ï¼Œä¸è¦ç”Ÿæ°”ï¼›ç›¸åï¼Œå¯ä»¥è‡ªå·±è¯•ç€å»è§£å†³ï¼Œæˆ–è€…ç»™æˆ‘ä»¬å‘ä¸€å°å‹å¥½çš„ç”µå­é‚®ä»¶ã€‚è¯·æäº¤ï¼ˆå‹å¥½çš„ï¼ï¼‰é”™è¯¯æŠ¥å‘Šåˆ°6.830-staff@mit.eduã€‚å½“ä½ è¿™æ ·åšæ—¶ï¼Œè¯·å°½é‡åŒ…æ‹¬ã€‚</p>
<p>A description of the bug.</p>
<p>A .java file we can drop in the src/simpledb/test directory, compile, and run.</p>
<p>A .txt file with the data that reproduces the bug. We should be able to convert it to a .dat file using PageEncoder.</p>
<p>You can also post on the class page on Piazza if you feel you have run into a bug.</p>
<p>å¯¹è¯¥é”™è¯¯çš„æè¿°ã€‚</p>
<p>ä¸€ä¸ª.javaæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¾åˆ°src/simpledb/testç›®å½•ä¸‹ï¼Œè¿›è¡Œç¼–è¯‘ï¼Œç„¶åè¿è¡Œã€‚</p>
<p>ä¸€ä¸ªåŒ…å«å†ç°è¯¥é”™è¯¯çš„æ•°æ®çš„.txtæ–‡ä»¶ã€‚æˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿç”¨PageEncoderå°†å…¶è½¬æ¢ä¸ºä¸€ä¸ª.datæ–‡ä»¶ã€‚</p>
<p>å¦‚æœä½ è§‰å¾—ä½ é‡åˆ°äº†ä¸€ä¸ªbugï¼Œä½ ä¹Ÿå¯ä»¥åœ¨Piazzaä¸Šçš„ç­çº§é¡µé¢ä¸Šå‘å¸–ã€‚</p>
<h2 id="44-grading"><a class="header" href="#44-grading">4.4 Grading</a></h2>
<p>75% of your grade will be based on whether or not your code passes the system test suite we will run over it. These tests will be a superset of the tests we have provided. Before handing in your code, you should make sure it produces no errors (passes all of the tests) from both ant test and ant systemtest.</p>
<p>ä½ çš„æˆç»©çš„75%å°†åŸºäºä½ çš„ä»£ç æ˜¯å¦é€šè¿‡æˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œçš„ç³»ç»Ÿæµ‹è¯•å¥—ä»¶ã€‚è¿™äº›æµ‹è¯•å°†æ˜¯æˆ‘ä»¬æä¾›çš„æµ‹è¯•çš„ä¸€ä¸ªè¶…é›†ã€‚åœ¨äº¤å‡ºä½ çš„ä»£ç ä¹‹å‰ï¼Œä½ åº”è¯¥ç¡®ä¿å®ƒåœ¨ant testå’Œant systemtestä¸­æ²¡æœ‰äº§ç”Ÿé”™è¯¯ï¼ˆé€šè¿‡æ‰€æœ‰çš„æµ‹è¯•ï¼‰ã€‚</p>
<p>Important: before testing, gradescope will replace your build.xml, HeapFileEncoder.java and the entire contents of the test directory with our version of these files. This means you cannot change the format of .dat files! You should also be careful changing our APIs. You should test that your code compiles the unmodified tests.</p>
<p>é‡è¦çš„æ˜¯ï¼šåœ¨æµ‹è¯•ä¹‹å‰ï¼Œgradescope ä¼šç”¨æˆ‘ä»¬çš„ç‰ˆæœ¬æ›¿æ¢ä½ çš„ build.xmlã€HeapFileEncoder.java ä»¥åŠæµ‹è¯•ç›®å½•ä¸­çš„å…¨éƒ¨å†…å®¹ã€‚è¿™æ„å‘³ç€ä½ ä¸èƒ½æ”¹å˜.datæ–‡ä»¶çš„æ ¼å¼! ä½ ä¹Ÿåº”è¯¥å°å¿ƒæ”¹å˜æˆ‘ä»¬çš„APIã€‚ä½ åº”è¯¥æµ‹è¯•ä½ çš„ä»£ç æ˜¯å¦ç¼–è¯‘äº†æœªä¿®æ”¹çš„æµ‹è¯•ã€‚</p>
<p>You should get immediate feedback and error outputs for failed tests (if any) from gradescope after submission. The score given will be your grade for the autograded portion of the assignment. An additional 25% of your grade will be based on the quality of your writeup and our subjective evaluation of your code. This part will also be published on gradescope after we finish grading your assignment.</p>
<p>åœ¨æäº¤åï¼Œä½ åº”è¯¥ä» gradescope å¾—åˆ°å³æ—¶åé¦ˆå’Œå¤±è´¥æµ‹è¯•çš„é”™è¯¯è¾“å‡ºï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ç»™å‡ºçš„åˆ†æ•°å°†æ˜¯ä½ åœ¨ä½œä¸šçš„è‡ªåŠ¨è¯„åˆ†éƒ¨åˆ†çš„æˆç»©ã€‚å¦å¤–25%çš„åˆ†æ•°å°†åŸºäºä½ çš„å†™ä½œè´¨é‡å’Œæˆ‘ä»¬å¯¹ä½ ä»£ç çš„ä¸»è§‚è¯„ä»·ã€‚åœ¨æˆ‘ä»¬ç»™ä½ çš„ä½œä¸šè¯„åˆ†åï¼Œè¿™éƒ¨åˆ†ä¹Ÿå°†åœ¨ gradescope ä¸Šå…¬å¸ƒã€‚</p>
<p>We had a lot of fun designing this assignment, and we hope you enjoy hacking on it!</p>
<p>æˆ‘ä»¬åœ¨è®¾è®¡è¿™é¡¹ä½œä¸šæ—¶éå¸¸æœ‰è¶£ï¼Œæˆ‘ä»¬å¸Œæœ›ä½ èƒ½äº«å—åˆ°é»‘å®¢çš„ä¹è¶£!</p>

                    <div id="giscus-container"></div>
                </main>

                <nav class="nav-wrapper" aria-label="Page navigation">
                    <!-- Mobile navigation buttons -->
                    <a rel="prev" href="../../6.830/cn/6-lab5.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../6.824/0-lab0.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>

                    <div style="clear: both"></div>
                </nav>
            </div>
        </div>

        <nav class="nav-wide-wrapper" aria-label="Page navigation">
            <a rel="prev" href="../../6.830/cn/6-lab5.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                <i class="fa fa-angle-left"></i>
            </a>

            <a rel="next" href="../../6.824/0-lab0.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                <i class="fa fa-angle-right"></i>
            </a>
        </nav>

    </div>




    <script type="text/javascript">
        window.playground_copyable = true;
    </script>

    <script src="../../ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../editor.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../mode-rust.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

    <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

    <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../book.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
        var pagePath = "6.830/cn/7-lab6.md"
    </script>


    <!-- Custom JS scripts -->


</body>
</html>