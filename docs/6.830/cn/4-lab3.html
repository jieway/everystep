<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js light">
<head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8">
    <title>Lab 3 (Chinese) - everystep</title>


    <!-- Custom HTML head -->
    
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff" />

    <link rel="icon" href="../../favicon.svg">
    <link rel="shortcut icon" href="../../favicon.png">
    <link rel="stylesheet" href="../../css/variables.css">
    <link rel="stylesheet" href="../../css/general.css">
    <link rel="stylesheet" href="../../css/chrome.css">
    <link rel="stylesheet" href="../../css/print.css" media="print">

    <!-- Fonts -->
    <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
    <link rel="stylesheet" href="../../fonts/fonts.css">

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="../../highlight.css">
    <link rel="stylesheet" href="../../tomorrow-night.css">
    <link rel="stylesheet" href="../../ayu-highlight.css">

    <!-- Custom theme stylesheets -->
    <link rel="stylesheet" href="../../theme/style.css">


</head>
<body>
    <!-- Provide site root to javascript -->
    <script type="text/javascript">
        var path_to_root = "../../";
        var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
    </script>

    <!-- Work around some values being stored in localStorage wrapped in quotes -->
    <script type="text/javascript">
        try {
            var theme = localStorage.getItem('mdbook-theme');
            var sidebar = localStorage.getItem('mdbook-sidebar');
            if (theme.startsWith('"') && theme.endsWith('"')) {
                localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
            }
            if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
            }
        } catch (e) { }
    </script>

    <!-- Set the theme before any content is loaded, prevents flash -->
    <script type="text/javascript">
        var theme;
        try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
        if (theme === null || theme === undefined) { theme = default_theme; }
        var html = document.querySelector('html');
        html.classList.remove('no-js')
        html.classList.remove('light')
        html.classList.add(theme);
        html.classList.add('js');
    </script>

    <!-- Hide / unhide sidebar before it is displayed -->
    <script type="text/javascript">
        var html = document.querySelector('html');
        var sidebar = 'hidden';
        if (document.body.clientWidth >= 1080) {
            try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
            sidebar = sidebar || 'visible';
        }
        html.classList.remove('sidebar-visible');
        html.classList.add("sidebar-" + sidebar);
    </script>

    <nav id="sidebar" class="sidebar" aria-label="Table of contents">
        <div class="sidebar-scrollbox">
            <ol class="chapter"><li class="chapter-item affix "><a href="../../index.html">ç®€ä»‹</a></li><li class="chapter-item affix "><li class="part-title">ğŸ­ æ“ä½œç³»ç»Ÿ</li><li class="spacer"></li><li class="chapter-item "><a href="../../6.S081/0-summary.html"><strong aria-hidden="true">1.</strong> 6.S081</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../6.S081/1-lab1.html"><strong aria-hidden="true">1.1.</strong> Lab 1</a></li><li class="chapter-item "><a href="../../6.S081/2-lab2.html"><strong aria-hidden="true">1.2.</strong> Lab 2</a></li><li class="chapter-item "><a href="../../6.S081/3-lab3.html"><strong aria-hidden="true">1.3.</strong> Lab 3</a></li><li class="chapter-item "><a href="../../6.S081/4-lab4.html"><strong aria-hidden="true">1.4.</strong> Lab 4</a></li><li class="chapter-item "><a href="../../6.S081/5-lab5.html"><strong aria-hidden="true">1.5.</strong> Lab 5</a></li><li class="chapter-item "><a href="../../6.S081/6-lab6.html"><strong aria-hidden="true">1.6.</strong> Lab 6</a></li><li class="chapter-item "><a href="../../6.S081/7-lab7.html"><strong aria-hidden="true">1.7.</strong> Lab 7</a></li><li class="chapter-item "><a href="../../6.S081/8-lab8.html"><strong aria-hidden="true">1.8.</strong> Lab 8</a></li><li class="chapter-item "><a href="../../6.S081/9-lab9.html"><strong aria-hidden="true">1.9.</strong> Lab 9</a></li><li class="chapter-item "><a href="../../6.S081/10-lab10.html"><strong aria-hidden="true">1.10.</strong> Lab 10</a></li><li class="chapter-item "><a href="../../6.S081/11-lab11.html"><strong aria-hidden="true">1.11.</strong> Lab 11</a></li></ol></li><li class="chapter-item "><li class="part-title">ğŸš€ æ•°æ®åº“</li><li class="spacer"></li><li class="chapter-item "><a href="../../bitcask/index.html"><strong aria-hidden="true">2.</strong> ä»é›¶å®ç° BitCask å­˜å‚¨å¼•æ“</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.1.</strong> BitCask ç®€ä»‹</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.2.</strong> åˆ›å»º C++ é¡¹ç›®</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.3.</strong> æ•°æ®åœ¨å†…å­˜ä¸­</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.4.</strong> æ•°æ®åœ¨ç£ç›˜ä¸Š</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.5.</strong> BenchMark</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.6.</strong> å®ç°åˆå¹¶</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.7.</strong> å®ç°åƒåœ¾å›æ”¶</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.8.</strong> hintfile å®ç°</a></li><li class="chapter-item "><a href="../../bitcask/p1.html"><strong aria-hidden="true">2.9.</strong> å“ˆå¸Œè¡¨ä¼˜åŒ–ä¸ºå¤šçº¿ç¨‹</a></li><li class="chapter-item "><a href="../../bitcask/ch1.html"><strong aria-hidden="true">2.10.</strong> æ•°æ®åœ¨ç£ç›˜ä¸Šå¦‚ä½•å­˜æ”¾ï¼Ÿ</a></li><li class="chapter-item "><a href="../../bitcask/ch2.html"><strong aria-hidden="true">2.11.</strong> å­˜å‚¨å¼•æ“çš„æ¥å£è®¾è®¡</a></li><li class="chapter-item "><a href="../../bitcask/ch3.html"><strong aria-hidden="true">2.12.</strong> å®ç° Setã€Get</a></li><li class="chapter-item "><a href="../../bitcask/ch4.html"><strong aria-hidden="true">2.13.</strong> åˆ é™¤é€»è¾‘å’Œ Compact </a></li></ol></li><li class="chapter-item "><a href="../../abyssdb/p0.html"><strong aria-hidden="true">3.</strong> ä»é›¶å®ç°å…³ç³»å‹æ•°æ®åº“</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../abyssdb/p1.html"><strong aria-hidden="true">3.1.</strong> ä» Table å¼€å§‹</a></li><li class="chapter-item "><a href="../../abyssdb/p2.html"><strong aria-hidden="true">3.2.</strong> Part 2. å®ç° Tuple</a></li><li class="chapter-item "><a href="../../abyssdb/p3.html"><strong aria-hidden="true">3.3.</strong> Part 3. å®ç° Page</a></li><li class="chapter-item "><a href="../../abyssdb/p4.html"><strong aria-hidden="true">3.4.</strong> Part 4. å®ç° HeapFile</a></li><li class="chapter-item "><a href="../../abyssdb/p5.html"><strong aria-hidden="true">3.5.</strong> Part 5. å®ç° BufferPool</a></li><li class="chapter-item "><a href="../../abyssdb/p6.html"><strong aria-hidden="true">3.6.</strong> Part 6. æ”¯æŒ int å’Œ string ç­‰æ•°æ®ç±»å‹ã€‚</a></li><li class="chapter-item "><a href="../../abyssdb/p7.html"><strong aria-hidden="true">3.7.</strong> Part 7. å®ç° Catalog</a></li></ol></li><li class="chapter-item expanded "><a href="../../6.830/1-lab0.html"><strong aria-hidden="true">4.</strong> 6.830</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../6.830/ans/2-lab1-ans.html"><strong aria-hidden="true">4.1.</strong> Lab 1 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/3-lab2-ans.html"><strong aria-hidden="true">4.2.</strong> Lab 2 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/4-lab3-ans.html"><strong aria-hidden="true">4.3.</strong> Lab 3 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/5-lab4-ans.html"><strong aria-hidden="true">4.4.</strong> Lab 4 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/6-lab5-ans.html"><strong aria-hidden="true">4.5.</strong> Lab 5 Answers</a></li><li class="chapter-item "><a href="../../6.830/ans/7-lab6-ans.html"><strong aria-hidden="true">4.6.</strong> Lab 6 Answers</a></li><li class="chapter-item "><a href="../../6.830/cn/2-lab1.html"><strong aria-hidden="true">4.7.</strong> Lab 1 (Chinese)</a></li><li class="chapter-item "><a href="../../6.830/cn/3-lab2.html"><strong aria-hidden="true">4.8.</strong> Lab 2 (Chinese)</a></li><li class="chapter-item expanded "><a href="../../6.830/cn/4-lab3.html" class="active"><strong aria-hidden="true">4.9.</strong> Lab 3 (Chinese)</a></li><li class="chapter-item "><a href="../../6.830/cn/5-lab4.html"><strong aria-hidden="true">4.10.</strong> Lab 4 (Chinese)</a></li><li class="chapter-item "><a href="../../6.830/cn/6-lab5.html"><strong aria-hidden="true">4.11.</strong> Lab 5 (Chinese)</a></li><li class="chapter-item "><a href="../../6.830/cn/7-lab6.html"><strong aria-hidden="true">4.12.</strong> Lab 6 (Chinese)</a></li></ol></li><li class="chapter-item "><li class="part-title">ğŸ§Š åˆ†å¸ƒå¼</li><li class="spacer"></li><li class="chapter-item "><a href="../../6.824/0-lab0.html"><strong aria-hidden="true">5.</strong> 6.824</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../6.824/1-lab1-cn.html"><strong aria-hidden="true">5.1.</strong> Lab 1 (Chinese)</a></li><li class="chapter-item "><a href="../../6.824/1-lab1.html"><strong aria-hidden="true">5.2.</strong> Lab 1</a></li><li class="chapter-item "><a href="../../6.824/2-lab2-cn.html"><strong aria-hidden="true">5.3.</strong> Lab 2 (Chinese)</a></li><li class="chapter-item "><a href="../../6.824/2-lab2.html"><strong aria-hidden="true">5.4.</strong> Lab 2</a></li></ol></li><li class="chapter-item "><li class="part-title">ğŸ”¥ å…¶ä»–</li><li class="spacer"></li><li class="chapter-item "><a href="../../6.828/0-sum.html"><strong aria-hidden="true">6.</strong> 6.828</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../6.828/1-env.html"><strong aria-hidden="true">6.1.</strong> Environment Setup</a></li><li class="chapter-item "><a href="../../6.828/1-part1.html"><strong aria-hidden="true">6.2.</strong> Part 1</a></li></ol></li><li class="chapter-item "><a href="../../review/1_go.html"><strong aria-hidden="true">7.</strong> å…«è‚¡</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../review/2_cpp.html"><strong aria-hidden="true">7.1.</strong> C++</a></li><li class="chapter-item "><a href="../../review/3_cn.html"><strong aria-hidden="true">7.2.</strong> Computer Networks</a></li></ol></li><li class="chapter-item "><a href="../../lsm/index.html"><strong aria-hidden="true">8.</strong> ä»é›¶å®ç° LSM-Tree å­˜å‚¨å¼•æ“</a><a class="toggle"><div>â±</div></a></li><li><ol class="section"><li class="chapter-item "><a href="../../lsm/ch1.html"><strong aria-hidden="true">8.1.</strong> Part 1</a></li><li class="chapter-item "><a href="../../lsm/ch2.html"><strong aria-hidden="true">8.2.</strong> Part 2</a></li><li class="chapter-item "><a href="../../lsm/ch3.html"><strong aria-hidden="true">8.3.</strong> Part 3</a></li><li class="chapter-item "><a href="../../lsm/ch4.html"><strong aria-hidden="true">8.4.</strong> Part 4</a></li></ol></li></ol>
        </div>
        <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
    </nav>

    <div id="page-wrapper" class="page-wrapper">

        <div class="page">
                        <div id="menu-bar-hover-placeholder"></div>
            <div id="menu-bar" class="menu-bar sticky bordered">
                <div class="left-buttons">
                    <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                        <i class="fa fa-bars"></i>
                    </button>
                    <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                        <i class="fa fa-paint-brush"></i>
                    </button>
                    <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                        <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                        <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                    </ul>
                    <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                        <i class="fa fa-search"></i>
                    </button>
                </div>

                <h1 class="menu-title">everystep</h1>

                <div class="right-buttons">
                    <a href="../../print.html" title="Print this book" aria-label="Print this book">
                        <i id="print-button" class="fa fa-print"></i>
                    </a>
                    <a href="https://github.com/weijiew/everystep" title="Git repository" aria-label="Git repository">
                        <i id="git-repository-button" class="fa fa-github"></i>
                    </a>
                    <a href="https://github.com/weijiew/everystep/edit/master/src/6.830/cn/4-lab3.md" title="Suggest an edit" aria-label="Suggest an edit">
                        <i id="git-edit-button" class="fa fa-edit"></i>
                    </a>

                </div>
            </div>

            <div id="search-wrapper" class="hidden">
                <form id="searchbar-outer" class="searchbar-outer">
                    <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                </form>
                <div id="searchresults-outer" class="searchresults-outer hidden">
                    <div id="searchresults-header" class="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
            </div>

            <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
            <script type="text/javascript">
                document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');

                // Get viewed page store
                var viewed_key = 'mdbook-viewed';
                var viewed_map = {};
                try {
                    var viewed_storage = localStorage.getItem(viewed_key);
                    if (viewed_storage) {
                        viewed_map = JSON.parse(viewed_storage)
                    }
                } catch (e) { }

                Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                    link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);

                    // Apply viewed style
                    if (viewed_map[link.pathname]) {
                        link.classList.add('md-viewed')
                    }
                }); 

                // Mark viewed after 30s
                setTimeout(function() {
                    viewed_map[location.pathname] = 1;
                    localStorage.setItem(viewed_key, JSON.stringify(viewed_map));
                }, 30000)
            </script>

            <div id="content" class="content">
                <!-- Page table of contents -->
                <div class="sidetoc"><nav class="pagetoc"></nav></div>
                <main>
                    <h1 id="lab-3-ç¿»è¯‘"><a class="header" href="#lab-3-ç¿»è¯‘">Lab 3 ç¿»è¯‘</a></h1>
<p>Assigned: Wednesday, Mar 17, 2021
Due: Tuesday, Apr 6, 2021</p>
<p>In this lab, you will implement a query optimizer on top of SimpleDB. The main tasks include implementing a selectivity estimation framework and a cost-based optimizer. You have freedom as to exactly what you implement, but we recommend using something similar to the Selinger cost-based optimizer discussed in class (Lecture 9).</p>
<p>åœ¨è¿™ä¸ªå®å®¤ä¸­ï¼Œä½ å°†åœ¨SimpleDBä¹‹ä¸Šå®ç°ä¸€ä¸ªæŸ¥è¯¢ä¼˜åŒ–å™¨ã€‚ä¸»è¦ä»»åŠ¡åŒ…æ‹¬å®ç°ä¸€ä¸ªé€‰æ‹©æ€§ä¼°è®¡æ¡†æ¶å’Œä¸€ä¸ªåŸºäºæˆæœ¬çš„ä¼˜åŒ–å™¨ã€‚ä½ å¯ä»¥è‡ªç”±é€‰æ‹©å…·ä½“çš„å®ç°æ–¹å¼ï¼Œä½†æˆ‘ä»¬å»ºè®®ä½¿ç”¨ç±»ä¼¼äºè¯¾å ‚ä¸Šè®¨è®ºçš„SelingeråŸºäºæˆæœ¬çš„ä¼˜åŒ–å™¨ï¼ˆç¬¬9è®²ï¼‰ã€‚</p>
<p>The remainder of this document describes what is involved in adding optimizer support and provides a basic outline of how you do so.</p>
<p>æœ¬æ–‡ä»¶çš„å…¶ä½™éƒ¨åˆ†æè¿°äº†æ·»åŠ ä¼˜åŒ–å™¨æ”¯æŒæ‰€æ¶‰åŠçš„å†…å®¹ï¼Œå¹¶æä¾›äº†ä¸€ä¸ªå…³äºå¦‚ä½•æ·»åŠ ä¼˜åŒ–å™¨çš„åŸºæœ¬æ¦‚è¦ã€‚</p>
<p>As with the previous lab, we recommend that you start as early as possible.</p>
<p>ä¸å‰ä¸€ä¸ªå®å®¤ä¸€æ ·ï¼Œæˆ‘ä»¬å»ºè®®ä½ å°½å¯èƒ½æ—©åœ°å¼€å§‹ã€‚</p>
<h1 id="1-getting-started"><a class="header" href="#1-getting-started">1. Getting started</a></h1>
<p>You should begin with the code you submitted for Lab 2. (If you did not submit code for Lab 2, or your solution didn't work properly, contact us to discuss options.)</p>
<p>ä½ åº”è¯¥ä»ä½ ä¸ºå®å®¤2æäº¤çš„ä»£ç å¼€å§‹ã€‚ï¼ˆå¦‚æœä½ æ²¡æœ‰ä¸ºå®å®¤2æäº¤ä»£ç ï¼Œæˆ–è€…ä½ çš„è§£å†³æ–¹æ¡ˆæ²¡æœ‰æ­£å¸¸å·¥ä½œï¼Œè¯·ä¸æˆ‘ä»¬è”ç³»ï¼Œè®¨è®ºå„ç§æ–¹æ¡ˆã€‚ï¼‰</p>
<p>We have provided you with extra test cases as well as source code files for this lab that are not in the original code distribution you received. We again encourage you to develop your own test suite in addition to the ones we have provided.</p>
<p>æˆ‘ä»¬ä¸ºè¿™ä¸ªå®å®¤æä¾›äº†é¢å¤–çš„æµ‹è¯•æ¡ˆä¾‹ä»¥åŠæºä»£ç æ–‡ä»¶ï¼Œè¿™äº›æ–‡ä»¶ä¸åœ¨ä½ æ”¶åˆ°çš„åŸå§‹ä»£ç åˆ†å‘ä¸­ã€‚æˆ‘ä»¬å†æ¬¡é¼“åŠ±ä½ åœ¨æˆ‘ä»¬æä¾›çš„æµ‹è¯•æ¡ˆä¾‹ä¹‹å¤–ï¼Œå¼€å‘ä½ è‡ªå·±çš„æµ‹è¯•å¥—ä»¶ã€‚</p>
<p>You will need to add these new files to your release. The easiest way to do this is to change to your project directory (probably called simple-db-hw) and pull from the master GitHub repository:</p>
<p>ä½ å°†éœ€è¦æŠŠè¿™äº›æ–°æ–‡ä»¶æ·»åŠ åˆ°ä½ çš„ç‰ˆæœ¬ä¸­ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯æ¢åˆ°ä½ çš„é¡¹ç›®ç›®å½•ï¼ˆå¯èƒ½å«simple-db-hwï¼‰ï¼Œç„¶åä»GitHubçš„ä¸»ä»“åº“æ‹‰å‡ºã€‚</p>
<p>$ cd simple-db-hw
$ git pull upstream master</p>
<h2 id="11-implementation-hints"><a class="header" href="#11-implementation-hints">1.1. Implementation hints</a></h2>
<p>We suggest exercises along this document to guide your implementation, but you may find that a different order makes more sense for you. As before, we will grade your assignment by looking at your code and verifying that you have passed the test for the ant targets test and systemtest. See Section 3.4 for a complete discussion of grading and the tests you will need to pass.</p>
<p>æˆ‘ä»¬å»ºè®®æ²¿ç€è¿™ä»½æ–‡ä»¶è¿›è¡Œç»ƒä¹ ï¼Œä»¥æŒ‡å¯¼ä½ çš„å®æ–½ï¼Œä½†ä½ å¯èƒ½ä¼šå‘ç°ä¸åŒçš„é¡ºåºå¯¹ä½ æ›´æœ‰æ„ä¹‰ã€‚å’Œä»¥å‰ä¸€æ ·ï¼Œæˆ‘ä»¬å°†é€šè¿‡æŸ¥çœ‹ä½ çš„ä»£ç å¹¶éªŒè¯ä½ æ˜¯å¦é€šè¿‡äº†èš‚èšç›®æ ‡æµ‹è¯•å’Œsystemtestçš„æµ‹è¯•æ¥ç»™ä½ çš„ä½œä¸šè¯„åˆ†ã€‚å…³äºè¯„åˆ†å’Œä½ éœ€è¦é€šè¿‡çš„æµ‹è¯•çš„å®Œæ•´è®¨è®ºè§ç¬¬3.4èŠ‚ã€‚</p>
<p>Here's a rough outline of one way you might proceed with this lab. More details on these steps are given in Section 2 below.</p>
<p>ä¸‹é¢æ˜¯ä½ å¯èƒ½è¿›è¡Œè¿™ä¸ªå®éªŒçš„ä¸€ä¸ªç²—ç•¥å¤§çº²ã€‚å…³äºè¿™äº›æ­¥éª¤çš„æ›´å¤šç»†èŠ‚å°†åœ¨ä¸‹æ–‡ç¬¬2èŠ‚ç»™å‡ºã€‚</p>
<p>Implement the methods in the TableStats class that allow it to estimate selectivities of filters and cost of scans, using histograms (skeleton provided for the IntHistogram class) or some other form of statistics of your devising.</p>
<p>å®ç°TableStatsç±»ä¸­çš„æ–¹æ³•ï¼Œä½¿å…¶èƒ½å¤Ÿä½¿ç”¨ç›´æ–¹å›¾ï¼ˆIntHistogramç±»æä¾›çš„éª¨æ¶ï¼‰æˆ–ä½ è®¾è®¡çš„å…¶ä»–å½¢å¼çš„ç»Ÿè®¡æ•°æ®æ¥ä¼°è®¡è¿‡æ»¤å™¨çš„é€‰æ‹©æ€§å’Œæ‰«æçš„æˆæœ¬ã€‚</p>
<p>Implement the methods in the JoinOptimizer class that allow it to estimate the cost and selectivities of joins.</p>
<p>å®ç°JoinOptimizerç±»ä¸­çš„æ–¹æ³•ï¼Œä½¿å…¶èƒ½å¤Ÿä¼°è®¡ join çš„æˆæœ¬å’Œé€‰æ‹©æ€§ã€‚</p>
<p>Write the orderJoins method in JoinOptimizer. This method must produce an optimal ordering for a series of joins (likely using the Selinger algorithm), given statistics computed in the previous two steps.</p>
<p>ç¼–å†™JoinOptimizerä¸­çš„orderJoinsæ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•å¿…é¡»ä¸ºä¸€ç³»åˆ—çš„è¿æ¥äº§ç”Ÿä¸€ä¸ªæœ€ä½³çš„é¡ºåºï¼ˆå¯èƒ½ä½¿ç”¨Selingerç®—æ³•ï¼‰ï¼Œç»™å®šå‰ä¸¤ä¸ªæ­¥éª¤ä¸­è®¡ç®—çš„ç»Ÿè®¡æ•°æ®ã€‚</p>
<h1 id="2-optimizer-outline"><a class="header" href="#2-optimizer-outline">2. Optimizer outline</a></h1>
<p>Recall that the main idea of a cost-based optimizer is to:</p>
<p>å›é¡¾ä¸€ä¸‹ï¼ŒåŸºäºæˆæœ¬çš„ä¼˜åŒ–å™¨çš„ä¸»è¦æ€æƒ³æ˜¯ï¼š</p>
<p>Use statistics about tables to estimate &quot;costs&quot; of different query plans. Typically, the cost of a plan is related to the cardinalities of (number of tuples produced by) intermediate joins and selections, as well as the selectivity of filter and join predicates.</p>
<p>ä½¿ç”¨å…³äºè¡¨çš„ç»Ÿè®¡æ•°æ®æ¥ä¼°è®¡ä¸åŒæŸ¥è¯¢è®¡åˆ’çš„ &quot;æˆæœ¬&quot;ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªè®¡åˆ’çš„æˆæœ¬ä¸ä¸­é—´è¿æ¥å’Œé€‰æ‹©çš„cardinalitiesï¼ˆäº§ç”Ÿçš„ tuple æ•°é‡ï¼‰ï¼Œä»¥åŠè¿‡æ»¤å™¨å’Œè¿æ¥è°“è¯çš„é€‰æ‹©æ€§æœ‰å…³ã€‚</p>
<p>Use these statistics to order joins and selections in an optimal way, and to select the best implementation for join algorithms from amongst several alternatives.
In this lab, you will implement code to perform both of these functions.</p>
<p>åˆ©ç”¨è¿™äº›ç»Ÿè®¡æ•°æ®ï¼Œä»¥æœ€ä½³æ–¹å¼æ’åˆ—è¿æ¥å’Œé€‰æ‹©ï¼Œå¹¶ä»å‡ ä¸ªå¤‡é€‰æ–¹æ¡ˆä¸­é€‰æ‹©è¿æ¥ç®—æ³•çš„æœ€ä½³å®ç°ã€‚
åœ¨æœ¬å®å®¤ä¸­ï¼Œä½ å°†å®ç°ä»£ç ä»¥æ‰§è¡Œè¿™ä¸¤é¡¹åŠŸèƒ½ã€‚</p>
<p>The optimizer will be invoked from simpledb/Parser.java. You may wish to review the lab 2 parser exercise before starting this lab. Briefly, if you have a catalog file catalog.txt describing your tables, you can run the parser by typing:</p>
<p>ä¼˜åŒ–å™¨å°†ä»simpledb/Parser.javaè°ƒç”¨ã€‚åœ¨å¼€å§‹è¿™ä¸ªå®éªŒä¹‹å‰ï¼Œä½ å¯èƒ½å¸Œæœ›å›é¡¾ä¸€ä¸‹å®éªŒ2çš„è§£æå™¨ç»ƒä¹ ã€‚ç®€è€Œè¨€ä¹‹ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæè¿°ä½ çš„è¡¨çš„ç›®å½•æ–‡ä»¶catalog.txtï¼Œä½ å¯ä»¥é€šè¿‡è¾“å…¥æ¥è¿è¡Œè§£æå™¨ã€‚</p>
<p><code>java -jar dist/simpledb.jar parser catalog.txt</code></p>
<p>When the Parser is invoked, it will compute statistics over all of the tables (using statistics code you provide). When a query is issued, the parser will convert the query into a logical plan representation and then call your query optimizer to generate an optimal plan.</p>
<p>å½“è§£æå™¨è¢«è°ƒç”¨æ—¶ï¼Œå®ƒå°†å¯¹æ‰€æœ‰çš„è¡¨è¿›è¡Œç»Ÿè®¡è®¡ç®—ï¼ˆä½¿ç”¨ä½ æä¾›çš„ç»Ÿè®¡ä»£ç ï¼‰ã€‚å½“ä¸€ä¸ªæŸ¥è¯¢è¢«å‘å‡ºæ—¶ï¼Œè§£æå™¨å°†æŠŠæŸ¥è¯¢è½¬æ¢æˆé€»è¾‘è®¡åˆ’è¡¨ç¤ºï¼Œç„¶åè°ƒç”¨ä½ çš„æŸ¥è¯¢ä¼˜åŒ–å™¨æ¥ç”Ÿæˆä¸€ä¸ªæœ€ä½³è®¡åˆ’ã€‚</p>
<h2 id="21-overall-optimizer-structure"><a class="header" href="#21-overall-optimizer-structure">2.1 Overall Optimizer Structure</a></h2>
<p>Before getting started with the implementation, you need to understand the overall structure of the SimpleDB optimizer. The overall control flow of the SimpleDB modules of the parser and optimizer is shown in Figure 1.</p>
<p>åœ¨å¼€å§‹å®æ–½ä¹‹å‰ï¼Œä½ éœ€è¦äº†è§£SimpleDBä¼˜åŒ–å™¨çš„æ•´ä½“ç»“æ„ã€‚åˆ†æå™¨å’Œä¼˜åŒ–å™¨çš„SimpleDBæ¨¡å—çš„æ•´ä½“æ§åˆ¶æµç¨‹å¦‚å›¾1æ‰€ç¤ºã€‚</p>
<p><img src="image/4-lab3/1644226360588.png" alt="" />
Figure 1: Diagram illustrating classes, methods, and objects used in the parser</p>
<p>å›¾1ï¼šè¯´æ˜è§£æå™¨ä¸­ä½¿ç”¨çš„ç±»ã€æ–¹æ³•å’Œå¯¹è±¡çš„å›¾ç¤º</p>
<p>The key at the bottom explains the symbols; you will implement the components with double-borders. The classes and methods will be explained in more detail in the text that follows (you may wish to refer back to this diagram), but the basic operation is as follows:</p>
<p>åº•éƒ¨çš„ key è§£é‡Šäº†è¿™äº›ç¬¦å·ï¼›ä½ å°†å®ç°å¸¦æœ‰åŒè¾¹æ¡†çš„ç»„ä»¶ã€‚è¿™äº›ç±»å’Œæ–¹æ³•å°†åœ¨åé¢çš„æ–‡å­—ä¸­å¾—åˆ°æ›´è¯¦ç»†çš„è§£é‡Šï¼ˆä½ å¯èƒ½å¸Œæœ›å›è¿‡å¤´æ¥çœ‹çœ‹è¿™ä¸ªå›¾ï¼‰ï¼Œä½†åŸºæœ¬æ“ä½œå¦‚ä¸‹ã€‚</p>
<p>Parser.java constructs a set of table statistics (stored in the statsMap container) when it is initialized. It then waits for a query to be input, and calls the method parseQuery on that query.</p>
<p>Parser.javaåœ¨åˆå§‹åŒ–æ—¶æ„å»ºäº†ä¸€ç»„è¡¨çš„ç»Ÿè®¡æ•°æ®ï¼ˆå­˜å‚¨åœ¨statsMapå®¹å™¨ä¸­ï¼‰ã€‚ç„¶åå®ƒç­‰å¾…ä¸€ä¸ªæŸ¥è¯¢çš„è¾“å…¥ï¼Œå¹¶å¯¹è¯¥æŸ¥è¯¢è°ƒç”¨parseQueryæ–¹æ³•ã€‚</p>
<p>parseQuery first constructs a LogicalPlan that represents the parsed query. parseQuery then calls the method physicalPlan on the LogicalPlan instance it has constructed. The physicalPlan method returns a DBIterator object that can be used to actually run the query.</p>
<p>parseQueryé¦–å…ˆæ„å»ºä¸€ä¸ªä»£è¡¨è§£ææŸ¥è¯¢çš„LogicalPlanï¼Œç„¶ååœ¨å®ƒæ„å»ºçš„LogicalPlanå®ä¾‹ä¸Šè°ƒç”¨physicalPlanæ–¹æ³•ã€‚physicalPlanæ–¹æ³•è¿”å›ä¸€ä¸ªDBIteratorå¯¹è±¡ï¼Œå¯ç”¨äºå®é™…è¿è¡ŒæŸ¥è¯¢ã€‚</p>
<p>In the exercises to come, you will implement the methods that help physicalPlan devise an optimal plan.</p>
<p>åœ¨æ¥ä¸‹æ¥çš„ç»ƒä¹ ä¸­ï¼Œä½ å°†å®æ–½å¸®åŠ©physicalPlanè®¾è®¡ä¸€ä¸ªæœ€ä½³è®¡åˆ’çš„æ–¹æ³•ã€‚</p>
<h2 id="22-statistics-estimation"><a class="header" href="#22-statistics-estimation">2.2. Statistics Estimation</a></h2>
<p>Accurately estimating plan cost is quite tricky. In this lab, we will focus only on the cost of sequences of joins and base table accesses. We won't worry about access method selection (since we only have one access method, table scans) or the costs of additional operators (like aggregates).</p>
<p>å‡†ç¡®åœ°ä¼°è®¡è®¡åˆ’æˆæœ¬æ˜¯ç›¸å½“æ£˜æ‰‹çš„ã€‚åœ¨è¿™ä¸ªå®å®¤ä¸­ï¼Œæˆ‘ä»¬å°†åªå…³æ³¨è¿æ¥åºåˆ—å’ŒåŸºæœ¬è¡¨è®¿é—®çš„æˆæœ¬ã€‚æˆ‘ä»¬ä¸ä¼šæ‹…å¿ƒè®¿é—®æ–¹æ³•çš„é€‰æ‹©ï¼ˆå› ä¸ºæˆ‘ä»¬åªæœ‰ä¸€ç§è®¿é—®æ–¹æ³•ï¼Œå³è¡¨æ‰«æï¼‰ï¼Œä¹Ÿä¸ä¼šæ‹…å¿ƒé¢å¤–è¿ç®—ç¬¦ï¼ˆå¦‚èšåˆï¼‰çš„æˆæœ¬ã€‚</p>
<p>You are only required to consider left-deep plans for this lab. See Section 2.3 for a description of additional &quot;bonus&quot; optimizer features you might implement, including an approach for handling bushy plans.</p>
<p>åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½ åªéœ€è¦è€ƒè™‘å·¦æ·±çš„è®¡åˆ’ã€‚å‚è§ç¬¬2.3èŠ‚ï¼Œäº†è§£ä½ å¯èƒ½å®ç°çš„é¢å¤–çš„ &quot;å¥–åŠ± &quot;ä¼˜åŒ–å™¨ç‰¹æ€§ï¼ŒåŒ…æ‹¬å¤„ç†æ‚ä¹±è®¡åˆ’çš„æ–¹æ³•ã€‚</p>
<h2 id="221-overall-plan-cost"><a class="header" href="#221-overall-plan-cost">2.2.1 Overall Plan Cost</a></h2>
<p>We will write join plans of the form p=t1 join t2 join ... tn, which signifies a left deep join where t1 is the left-most join (deepest in the tree). Given a plan like p, its cost can be expressed as:</p>
<p>æˆ‘ä»¬å°†ä»¥p=t1 join t2 join ... tnçš„å½¢å¼æ¥å†™è¿æ¥è®¡åˆ’ï¼Œè¿™è¡¨ç¤ºä¸€ä¸ªå·¦æ·±è¿æ¥ï¼Œå…¶ä¸­t1æ˜¯æœ€å·¦è¾¹çš„è¿æ¥ï¼ˆæ ‘ä¸­æœ€æ·±çš„ï¼‰ã€‚ç»™å®šä¸€ä¸ªåƒpè¿™æ ·çš„è®¡åˆ’ï¼Œå…¶æˆæœ¬å¯ä»¥è¡¨ç¤ºä¸ºã€‚</p>
<pre><code>scancost(t1) + scancost(t2) + joincost(t1 join t2) +
scancost(t3) + joincost((t1 join t2) join t3) +
... 
</code></pre>
<p>Here, scancost(t1) is the I/O cost of scanning table t1, joincost(t1,t2) is the CPU cost to join t1 to t2. To make I/O and CPU cost comparable, typically a constant scaling factor is used, e.g.:</p>
<p>è¿™é‡Œï¼Œscancost(t1)æ˜¯æ‰«æè¡¨t1çš„I/Oæˆæœ¬ï¼Œjoincost(t1,t2)æ˜¯è¿æ¥t1å’Œt2çš„CPUæˆæœ¬ã€‚ä¸ºäº†ä½¿I/Oå’ŒCPUæˆæœ¬å…·æœ‰å¯æ¯”æ€§ï¼Œé€šå¸¸ä½¿ç”¨ä¸€ä¸ªæ’å®šçš„æ¯”ä¾‹ç³»æ•°ï¼Œä¾‹å¦‚ã€‚</p>
<pre><code>cost(predicate application) = 1
cost(pageScan) = SCALING_FACTOR x cost(predicate application)
</code></pre>
<p>For this lab, you can ignore the effects of caching (e.g., assume that every access to a table incurs the full cost of a scan) -- again, this is something you may add as an optional bonus extension to your lab in Section 2.3. Therefore, scancost(t1) is simply the number of pages in t1 x SCALING_FACTOR.</p>
<p>åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½ å¯ä»¥å¿½ç•¥ç¼“å­˜çš„å½±å“ï¼ˆä¾‹å¦‚ï¼Œå‡è®¾å¯¹è¡¨çš„æ¯ä¸€æ¬¡è®¿é—®éƒ½ä¼šäº§ç”Ÿå…¨éƒ¨çš„æ‰«ææˆæœ¬ï¼‰--åŒæ ·ï¼Œè¿™ä¹Ÿæ˜¯ä½ å¯ä»¥åœ¨ç¬¬2.3èŠ‚ä¸­ä½œä¸ºä¸€ä¸ªå¯é€‰çš„é¢å¤–æ‰©å±•æ·»åŠ åˆ°å®éªŒä¸­çš„ä¸œè¥¿ã€‚å› æ­¤ï¼Œscancost(t1)åªæ˜¯t1çš„é¡µæ•°x SCALING_FACTORã€‚</p>
<h2 id="222-join-cost"><a class="header" href="#222-join-cost">2.2.2 Join Cost</a></h2>
<p>When using nested loops joins, recall that the cost of a join between two tables t1 and t2 (where t1 is the outer) is simply:</p>
<p>å½“ä½¿ç”¨åµŒå¥—å¾ªç¯è¿æ¥æ—¶ï¼Œè®°å¾—ä¸¤ä¸ªè¡¨t1å’Œt2ï¼ˆå…¶ä¸­t1æ˜¯å¤–è¡¨ï¼‰ä¹‹é—´çš„è¿æ¥æˆæœ¬æ˜¯ç®€å•çš„ã€‚</p>
<pre><code>joincost(t1 join t2) = scancost(t1) + ntups(t1) x scancost(t2) //IO cost
                    + ntups(t1) x ntups(t2)  //CPU cost
</code></pre>
<p>Here, ntups(t1) is the number of tuples in table t1.</p>
<p>è¿™é‡Œï¼Œntups(t1)æ˜¯è¡¨t1ä¸­ tuples çš„æ•°é‡ã€‚</p>
<h2 id="223-filter-selectivity"><a class="header" href="#223-filter-selectivity">2.2.3 Filter Selectivity</a></h2>
<p>ntups can be directly computed for a base table by scanning that table. Estimating ntups for a table with one or more selection predicates over it can be trickier -- this is the filter selectivity estimation problem. Here's one approach that you might use, based on computing a histogram over the values in the table:</p>
<p>ntupså¯ä»¥é€šè¿‡æ‰«æä¸€ä¸ªåŸºè¡¨ç›´æ¥è®¡ç®—å‡ºæ¥ã€‚å¯¹äºä¸€ä¸ªæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªé€‰æ‹©è°“è¯çš„è¡¨æ¥è¯´ï¼Œä¼°è®¡ntupså¯èƒ½æ¯”è¾ƒæ£˜æ‰‹--è¿™å°±æ˜¯è¿‡æ»¤å™¨çš„é€‰æ‹©æ€§ä¼°è®¡é—®é¢˜ã€‚ä¸‹é¢æ˜¯ä½ å¯èƒ½ä½¿ç”¨çš„ä¸€ç§æ–¹æ³•ï¼ŒåŸºäºè®¡ç®—è¡¨ä¸­çš„å€¼çš„ç›´æ–¹å›¾ã€‚</p>
<ul>
<li>Compute the minimum and maximum values for every attribute in the table (by scanning it once).</li>
</ul>
<p>è®¡ç®—è¡¨ä¸­æ¯ä¸ªå±æ€§çš„æœ€å°å€¼å’Œæœ€å¤§å€¼ï¼ˆé€šè¿‡æ‰«æä¸€æ¬¡ï¼‰ã€‚</p>
<ul>
<li>Construct a histogram for every attribute in the table. A simple approach is to use a fixed number of buckets NumB, with each bucket representing the number of records in a fixed range of the domain of the attribute of the histogram. For example, if a field f ranges from 1 to 100, and there are 10 buckets, then bucket 1 might contain the count of the number of records between 1 and 10, bucket 2 a count of the number of records between 11 and 20, and so on.</li>
</ul>
<p>ä¸ºè¡¨ä¸­çš„æ¯ä¸ªå±æ€§æ„å»ºä¸€ä¸ªç›´æ–¹å›¾ã€‚ä¸€ä¸ªç®€å•çš„æ–¹æ³•æ˜¯ä½¿ç”¨ä¸€ä¸ªå›ºå®šæ•°é‡çš„æ¡¶NumBï¼Œæ¯ä¸ªæ¡¶ä»£è¡¨ç›´æ–¹å›¾å±æ€§é¢†åŸŸçš„å›ºå®šèŒƒå›´å†…çš„è®°å½•æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå­—æ®µfçš„èŒƒå›´æ˜¯1åˆ°100ï¼Œæœ‰10ä¸ªæ¡¶ï¼Œé‚£ä¹ˆæ¡¶1å¯èƒ½åŒ…å«1åˆ°10ä¹‹é—´çš„è®°å½•æ•°ï¼Œæ¡¶2åŒ…å«11åˆ°20ä¹‹é—´çš„è®°å½•æ•°ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<ul>
<li>Scan the table again, selecting out all of fields of all of the tuples and using them to populate the counts of the buckets in each histogram.</li>
</ul>
<p>å†æ¬¡æ‰«æè¯¥è¡¨ï¼Œé€‰æ‹©å‡ºæ‰€æœ‰ tuples çš„æ‰€æœ‰å­—æ®µï¼Œç”¨å®ƒä»¬æ¥å¡«å……æ¯ä¸ªç›´æ–¹å›¾ä¸­çš„æ¡¶çš„è®¡æ•°ã€‚</p>
<ul>
<li>To estimate the selectivity of an equality expression, f=const, compute the bucket that contains value const. Suppose the width (range of values) of the bucket is w, the height (number of tuples) is h, and the number of tuples in the table is ntups. Then, assuming values are uniformly distributed throughout the bucket, the selectivity of the expression is roughly (h / w) / ntups, since (h/w) represents the expected number of tuples in the bin with value const.</li>
</ul>
<p>ä¸ºäº†ä¼°è®¡ä¸€ä¸ªå¹³ç­‰è¡¨è¾¾å¼f=constçš„é€‰æ‹©æ€§ï¼Œè®¡ç®—åŒ…å«å€¼constçš„æ¡¶ã€‚å‡è®¾æ¡¶çš„å®½åº¦ï¼ˆå€¼çš„èŒƒå›´ï¼‰æ˜¯wï¼Œé«˜åº¦ï¼ˆ tuples çš„æ•°é‡ï¼‰æ˜¯hï¼Œè€Œè¡¨ä¸­ tuples çš„æ•°é‡æ˜¯ntupsã€‚é‚£ä¹ˆï¼Œå‡è®¾å€¼åœ¨æ•´ä¸ªæ¡¶ä¸­æ˜¯å‡åŒ€åˆ†å¸ƒçš„ï¼Œè¡¨è¾¾å¼çš„é€‰æ‹©æ€§å¤§è‡´ä¸º(h/w)/ntupsï¼Œå› ä¸º(h/w)ä»£è¡¨çš„æ˜¯æ¡¶ä¸­å«æœ‰å€¼å¸¸æ•°çš„ tuples çš„é¢„æœŸæ•°é‡ã€‚</p>
<ul>
<li>To estimate the selectivity of a range expression f&gt;const, compute the bucket b that const is in, with width w_b and height h_b. Then, b contains a fraction b_f = h_b / ntups of the total tuples. Assuming tuples are uniformly distributed throughout b, the fraction b_part of b that is &gt; const is (b_right - const) / w_b, where b_right is the right endpoint of b's bucket. Thus, bucket b contributes (b_f x b_part) selectivity to the predicate. In addition, buckets b+1...NumB-1 contribute all of their selectivity (which can be computed using a formula similar to b_f above). Summing the selectivity contributions of all the buckets will yield the overall selectivity of the expression. Figure 2 illustrates this process.</li>
</ul>
<p>ä¸ºäº†ä¼°è®¡ä¸€ä¸ªèŒƒå›´è¡¨è¾¾å¼f&gt;constçš„é€‰æ‹©æ€§ï¼Œè®¡ç®—constæ‰€åœ¨çš„æ¡¶bï¼Œå…¶å®½åº¦ä¸ºw_bï¼Œé«˜åº¦ä¸ºh_bã€‚é‚£ä¹ˆï¼ŒbåŒ…å«äº†å…¨éƒ¨ tuples ä¸­çš„ä¸€éƒ¨åˆ†b_f = h_b / ntupsã€‚å‡è®¾ tuples å‡åŒ€åœ°åˆ†å¸ƒåœ¨æ•´ä¸ªbä¸­ï¼Œbä¸­å¤§äºconstçš„éƒ¨åˆ†b_partæ˜¯ï¼ˆb_right - constï¼‰/ w_bï¼Œå…¶ä¸­b_rightæ˜¯bçš„æ¡¶çš„å³ç«¯ç‚¹ã€‚å› æ­¤ï¼Œbæ¡¶å¯¹è°“è¯è´¡çŒ®äº†ï¼ˆb_f x b_partï¼‰çš„é€‰æ‹©æ€§ã€‚æ­¤å¤–ï¼Œb+1...NumB-1æ¡¶è´¡çŒ®äº†å®ƒä»¬æ‰€æœ‰çš„é€‰æ‹©æ€§ï¼ˆå¯ä»¥ç”¨ç±»ä¼¼äºä¸Šé¢b_fçš„å…¬å¼æ¥è®¡ç®—ï¼‰ã€‚å°†æ‰€æœ‰æ¡¶çš„é€‰æ‹©æ€§è´¡çŒ®ç›¸åŠ ï¼Œå°†äº§ç”Ÿè¡¨è¾¾å¼çš„æ•´ä½“é€‰æ‹©æ€§ã€‚å›¾2è¯´æ˜äº†è¿™ä¸ªè¿‡ç¨‹ã€‚</p>
<ul>
<li>Selectivity of expressions involving less than can be performed similar to the greater than case, looking at buckets down to 0.</li>
</ul>
<p>æ¶‰åŠå°äºçš„è¡¨è¾¾å¼çš„é€‰æ‹©æ€§å¯ä»¥ç±»ä¼¼äºå¤§äºçš„æƒ…å†µä¸‹è¿›è¡Œï¼Œçœ‹ä¸‹åˆ°0çš„æ¡¶ã€‚</p>
<p><img src="/6.830/4-lab3/1644227082669.png" alt="" /></p>
<p>In the next two exercises, you will code to perform selectivity estimation of joins and filters.</p>
<p>åœ¨æ¥ä¸‹æ¥çš„ä¸¤ä¸ªç»ƒä¹ ä¸­ï¼Œä½ å°†ç”¨ä»£ç æ¥æ‰§è¡Œè¿æ¥å’Œè¿‡æ»¤å™¨çš„é€‰æ‹©æ€§ä¼°è®¡ã€‚</p>
<h2 id="exercise-1-inthistogramjava"><a class="header" href="#exercise-1-inthistogramjava">Exercise 1: IntHistogram.java</a></h2>
<p>You will need to implement some way to record table statistics for selectivity estimation. We have provided a skeleton class, IntHistogram that will do this. Our intent is that you calculate histograms using the bucket-based method described above, but you are free to use some other method so long as it provides reasonable selectivity estimates.</p>
<p>ä½ å°†éœ€è¦å®ç°ä¸€äº›æ–¹æ³•æ¥è®°å½•è¡¨çš„ç»Ÿè®¡æ•°æ®ï¼Œä»¥ä¾¿è¿›è¡Œé€‰æ‹©æ€§ä¼°è®¡ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªéª¨æ¶ç±»ï¼ŒIntHistogramï¼Œå®ƒå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚æˆ‘ä»¬çš„ç›®çš„æ˜¯è®©ä½ ä½¿ç”¨ä¸Šé¢æè¿°çš„åŸºäºæ¡¶çš„æ–¹æ³•æ¥è®¡ç®—ç›´æ–¹å›¾ï¼Œä½†ä½ ä¹Ÿå¯ä»¥è‡ªç”±åœ°ä½¿ç”¨å…¶ä»–æ–¹æ³•ï¼Œåªè¦å®ƒèƒ½æä¾›åˆç†çš„é€‰æ‹©æ€§ä¼°è®¡ã€‚</p>
<p>We have provided a class StringHistogram that uses IntHistogram to compute selecitivites for String predicates. You may modify StringHistogram if you want to implement a better estimator, though you should not need to in order to complete this lab.</p>
<p>æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªStringHistogramç±»ï¼Œå®ƒä½¿ç”¨IntHistogramæ¥è®¡ç®—å­—ç¬¦ä¸²è°“è¯çš„é€‰å–ã€‚å¦‚æœä½ æƒ³å®ç°ä¸€ä¸ªæ›´å¥½çš„ä¼°è®¡å™¨ï¼Œä½ å¯ä»¥ä¿®æ”¹StringHistogramï¼Œå°½ç®¡ä½ ä¸éœ€è¦ä¸ºäº†å®Œæˆè¿™ä¸ªå®éªŒè€Œä¿®æ”¹ã€‚</p>
<p>After completing this exercise, you should be able to pass the IntHistogramTest unit test (you are not required to pass this test if you choose not to implement histogram-based selectivity estimation).</p>
<p>å®Œæˆè¿™ä¸ªç»ƒä¹ åï¼Œä½ åº”è¯¥èƒ½å¤Ÿé€šè¿‡IntHistogramTestå•å…ƒæµ‹è¯•ï¼ˆå¦‚æœä½ é€‰æ‹©ä¸å®ç°åŸºäºç›´æ–¹å›¾çš„é€‰æ‹©æ€§ä¼°è®¡ï¼Œä½ ä¸éœ€è¦é€šè¿‡è¿™ä¸ªæµ‹è¯•ï¼‰ã€‚</p>
<h2 id="exercise-2-tablestatsjava"><a class="header" href="#exercise-2-tablestatsjava">Exercise 2: TableStats.java</a></h2>
<p>The class TableStats contains methods that compute the number of tuples and pages in a table and that estimate the selectivity of predicates over the fields of that table. The query parser we have created creates one instance of TableStats per table, and passes these structures into your query optimizer (which you will need in later exercises).</p>
<p>TableStatsç±»åŒ…å«äº†è®¡ç®—ä¸€ä¸ªè¡¨ä¸­ tuples å’Œé¡µæ•°çš„æ–¹æ³•ï¼Œä»¥åŠä¼°è®¡è¯¥è¡¨å­—æ®µä¸Šçš„è°“è¯çš„é€‰æ‹©æ€§çš„æ–¹æ³•ã€‚æˆ‘ä»¬åˆ›å»ºçš„æŸ¥è¯¢åˆ†æå™¨ä¸ºæ¯ä¸ªè¡¨åˆ›å»ºä¸€ä¸ªTableStatsçš„å®ä¾‹ï¼Œå¹¶å°†è¿™äº›ç»“æ„ä¼ é€’ç»™ä½ çš„æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼ˆåœ¨åé¢çš„ç»ƒä¹ ä¸­ä½ ä¼šéœ€è¦å®ƒï¼‰ã€‚</p>
<p>You should fill in the following methods and classes in TableStats:</p>
<p>ä½ åº”è¯¥åœ¨TableStatsä¸­å¡«å†™ä»¥ä¸‹æ–¹æ³•å’Œç±»ã€‚</p>
<p>Implement the TableStats constructor: Once you have implemented a method for tracking statistics such as histograms, you should implement the TableStats constructor, adding code to scan the table (possibly multiple times) to build the statistics you need.</p>
<p>å®ç°TableStatsæ„é€ å‡½æ•°ã€‚ä¸€æ—¦ä½ å®ç°äº†è·Ÿè¸ªç»Ÿè®¡çš„æ–¹æ³•ï¼Œå¦‚ç›´æ–¹å›¾ï¼Œä½ åº”è¯¥å®ç°TableStatsæ„é€ å‡½æ•°ï¼Œæ·»åŠ ä»£ç æ¥æ‰«æè¡¨ï¼ˆå¯èƒ½æ˜¯å¤šæ¬¡ï¼‰ä»¥å»ºç«‹ä½ éœ€è¦çš„ç»Ÿè®¡ã€‚</p>
<p>Implement estimateSelectivity(int field, Predicate.Op op, Field constant): Using your statistics (e.g., an IntHistogram or StringHistogram depending on the type of the field), estimate the selectivity of predicate field op constant on the table.</p>
<p>å®ç° estimateSelectivity(int field, Predicate.Op op, Field constant)ã€‚ä½¿ç”¨ä½ çš„ç»Ÿè®¡æ•°æ®ï¼ˆä¾‹å¦‚ï¼Œæ ¹æ®å­—æ®µçš„ç±»å‹ï¼Œä½¿ç”¨IntHistogramæˆ–StringHistogramï¼‰ï¼Œä¼°è®¡predicateå­—æ®µopå¸¸é‡å¯¹è¡¨çš„é€‰æ‹©æ€§ã€‚</p>
<p>Implement estimateScanCost(): This method estimates the cost of sequentially scanning the file, given that the cost to read a page is costPerPageIO. You can assume that there are no seeks and that no pages are in the buffer pool. This method may use costs or sizes you computed in the constructor.</p>
<p>å®ç° estimateScanCost()ã€‚è¿™ä¸ªæ–¹æ³•ä¼°è®¡é¡ºåºæ‰«ææ–‡ä»¶çš„æˆæœ¬ï¼Œè€ƒè™‘åˆ°è¯»å–ä¸€ä¸ªé¡µé¢çš„æˆæœ¬æ˜¯costPerPageIOã€‚ä½ å¯ä»¥å‡è®¾æ²¡æœ‰å¯»é“ï¼Œä¹Ÿæ²¡æœ‰é¡µé¢åœ¨ç¼“å†²æ± ä¸­ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨ä½ åœ¨æ„é€ å‡½æ•°ä¸­è®¡ç®—çš„æˆæœ¬æˆ–å¤§å°ã€‚</p>
<p>Implement estimateTableCardinality(double selectivityFactor): This method returns the number of tuples in the relation, given that a predicate with selectivity selectivityFactor is applied. This method may use costs or sizes you computed in the constructor.</p>
<p>å®ç° estimateTableCardinality(double selectivityFactor)ã€‚è¯¥æ–¹æ³•è¿”å›å…³ç³»ä¸­ tuples çš„æ•°é‡ï¼Œè€ƒè™‘åˆ°åº”ç”¨äº†å…·æœ‰é€‰æ‹©æ€§çš„selectivityFactorçš„è°“è¯ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ä½¿ç”¨ä½ åœ¨æ„é€ å‡½æ•°ä¸­è®¡ç®—çš„æˆæœ¬æˆ–å¤§å°ã€‚</p>
<p>You may wish to modify the constructor of TableStats.java to, for example, compute histograms over the fields as described above for purposes of selectivity estimation.</p>
<p>ä½ å¯èƒ½å¸Œæœ›ä¿®æ”¹TableStats.javaçš„æ„é€ å‡½æ•°ï¼Œä¾‹å¦‚ï¼Œä¸ºäº†é€‰æ‹©æ€§ä¼°è®¡çš„ç›®çš„ï¼Œè®¡ç®—ä¸Šè¿°å­—æ®µçš„ç›´æ–¹å›¾ã€‚</p>
<p>After completing these tasks you should be able to pass the unit tests in TableStatsTest.</p>
<p>å®Œæˆè¿™äº›ä»»åŠ¡åï¼Œä½ åº”è¯¥èƒ½å¤Ÿé€šè¿‡TableStatsTestçš„å•å…ƒæµ‹è¯•ã€‚</p>
<h2 id="224-join-cardinality"><a class="header" href="#224-join-cardinality">2.2.4 Join Cardinality</a></h2>
<p>Finally, observe that the cost for the join plan p above includes expressions of the form joincost((t1 join t2) join t3). To evaluate this expression, you need some way to estimate the size (ntups) of t1 join t2. This join cardinality estimation problem is harder than the filter selectivity estimation problem. In this lab, you aren't required to do anything fancy for this, though one of the optional excercises in Section 2.4 includes a histogram-based method for join selectivity estimation.</p>
<p>æœ€åï¼Œè§‚å¯Ÿä¸€ä¸‹ï¼Œä¸Šé¢çš„è¿æ¥è®¡åˆ’pçš„æˆæœ¬åŒ…æ‹¬å½¢å¼ä¸ºjoincost((t1 join t2) join t3)çš„è¡¨è¾¾ã€‚ä¸ºäº†è¯„ä¼°è¿™ä¸ªè¡¨è¾¾å¼ï¼Œä½ éœ€è¦ä¸€äº›æ–¹æ³•æ¥ä¼°è®¡t1 join t2çš„å¤§å°ï¼ˆntupsï¼‰ã€‚è¿™ä¸ªè¿æ¥cardinalityä¼°è®¡é—®é¢˜æ¯”è¿‡æ»¤å™¨çš„é€‰æ‹©æ€§ä¼°è®¡é—®é¢˜æ›´éš¾ã€‚åœ¨è¿™ä¸ªå®éªŒä¸­ï¼Œä½ ä¸éœ€è¦ä¸ºæ­¤åšä»»ä½•èŠ±å“¨çš„äº‹æƒ…ï¼Œå°½ç®¡ç¬¬2.4èŠ‚ä¸­çš„ä¸€ä¸ªå¯é€‰çš„ç»ƒä¹ åŒ…æ‹¬ä¸€ä¸ªåŸºäºç›´æ–¹å›¾çš„è¿æ¥é€‰æ‹©æ€§ä¼°è®¡çš„æ–¹æ³•ã€‚</p>
<p>While implementing your simple solution, you should keep in mind the following:</p>
<p>åœ¨å®æ–½ä½ çš„ç®€å•è§£å†³æ–¹æ¡ˆæ—¶ï¼Œä½ åº”è¯¥ç‰¢è®°ä»¥ä¸‹å‡ ç‚¹ã€‚</p>
<p>For equality joins, when one of the attributes is a primary key, the number of tuples produced by the join cannot be larger than the cardinality of the non-primary key attribute.</p>
<p>å¯¹äºç­‰ä»·è¿æ¥ï¼Œå½“å…¶ä¸­ä¸€ä¸ªå±æ€§æ˜¯ä¸»é”®æ—¶ï¼Œç”±è¿æ¥äº§ç”Ÿçš„ tuples çš„æ•°é‡ä¸èƒ½å¤§äºéä¸»é”®å±æ€§çš„cardinalityã€‚</p>
<p>For equality joins when there is no primary key, it's hard to say much about what the size of the output is -- it could be the size of the product of the cardinalities of the tables (if both tables have the same value for all tuples) -- or it could be 0. It's fine to make up a simple heuristic (say, the size of the larger of the two tables).</p>
<p>å¯¹äºæ²¡æœ‰ä¸»é”®çš„ç­‰ä»·è¿æ¥ï¼Œå¾ˆéš¾è¯´è¾“å‡ºçš„å¤§å°æ˜¯ä»€ä¹ˆ--å®ƒå¯èƒ½æ˜¯è¡¨çš„cardinalitiesçš„ä¹˜ç§¯çš„å¤§å°ï¼ˆå¦‚æœä¸¤ä¸ªè¡¨çš„æ‰€æœ‰ tuples éƒ½æœ‰ç›¸åŒçš„å€¼ï¼‰--æˆ–è€…å®ƒå¯èƒ½æ˜¯0ã€‚</p>
<p>For range scans, it is similarly hard to say anything accurate about sizes. The size of the output should be proportional to the sizes of the inputs. It is fine to assume that a fixed fraction of the cross-product is emitted by range scans (say, 30%). In general, the cost of a range join should be larger than the cost of a non-primary key equality join of two tables of the same size.</p>
<p>å¯¹äºèŒƒå›´æ‰«æï¼ŒåŒæ ·ä¹Ÿå¾ˆéš¾å¯¹å°ºå¯¸è¯´å¾—å‡†ç¡®ã€‚è¾“å‡ºçš„å¤§å°åº”è¯¥ä¸è¾“å…¥çš„å¤§å°æˆæ­£æ¯”ã€‚å‡è®¾äº¤å‰äº§ç‰©çš„ä¸€ä¸ªå›ºå®šéƒ¨åˆ†æ˜¯ç”±èŒƒå›´æ‰«æå‘å‡ºçš„ï¼ˆæ¯”å¦‚ï¼Œ30%ï¼‰ï¼Œæ˜¯å¯ä»¥çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒèŒƒå›´è¿æ¥çš„æˆæœ¬åº”è¯¥å¤§äºç›¸åŒå¤§å°çš„ä¸¤ä¸ªè¡¨çš„éä¸»é”®å¹³ç­‰è¿æ¥çš„æˆæœ¬ã€‚</p>
<h2 id="exercise-3-join-cost-estimation"><a class="header" href="#exercise-3-join-cost-estimation">Exercise 3: Join Cost Estimation</a></h2>
<p>The class JoinOptimizer.java includes all of the methods for ordering and computing costs of joins. In this exercise, you will write the methods for estimating the selectivity and cost of a join, specifically:</p>
<p>JoinOptimizer.javaç±»åŒ…æ‹¬æ‰€æœ‰ç”¨äºæ’åºå’Œè®¡ç®—è¿æ¥æˆæœ¬çš„æ–¹æ³•ã€‚åœ¨è¿™ä¸ªç»ƒä¹ ä¸­ï¼Œä½ å°†å†™å‡ºç”¨äºä¼°è®¡ join çš„ selectivity å’Œ cost çš„æ–¹æ³•ï¼Œç‰¹åˆ«æ˜¯ï¼š</p>
<p>Implement estimateJoinCost(LogicalJoinNode j, int card1, int card2, double cost1, double cost2): This method estimates the cost of join j, given that the left input is of cardinality card1, the right input of cardinality card2, that the cost to scan the left input is cost1, and that the cost to access the right input is card2. You can assume the join is an NL join, and apply the formula mentioned earlier.</p>
<p>å®ç° estimateJoinCost(LogicalJoinNode j, int card1, int card2, double cost1, double cost2) ã€‚è¿™ä¸ªæ–¹æ³•ä¼°è®¡äº†è¿æ¥jçš„æˆæœ¬ï¼Œè€ƒè™‘åˆ°å·¦è¾¹çš„è¾“å…¥æ˜¯cardinality card1ï¼Œå³è¾¹çš„è¾“å…¥æ˜¯cardinality card2ï¼Œæ‰«æå·¦è¾¹è¾“å…¥çš„æˆæœ¬æ˜¯cost1ï¼Œè®¿é—®å³è¾¹è¾“å…¥çš„æˆæœ¬æ˜¯card2ã€‚ä½ å¯ä»¥å‡è®¾è¿™ä¸ªè¿æ¥æ˜¯ä¸€ä¸ªNLè¿æ¥ï¼Œå¹¶åº”ç”¨å‰é¢æåˆ°çš„å…¬å¼ã€‚</p>
<p>Implement estimateJoinCardinality(LogicalJoinNode j, int card1, int card2, boolean t1pkey, boolean t2pkey): This method estimates the number of tuples output by join j, given that the left input is size card1, the right input is size card2, and the flags t1pkey and t2pkey that indicate whether the left and right (respectively) field is unique (a primary key).</p>
<p>å®ç° estimateJoinCardinality(LogicalJoinNode j, int card1, int card2, boolean t1pkey, boolean t2pkey) ã€‚è¿™ä¸ªæ–¹æ³•ä¼°è®¡äº†jè¿æ¥è¾“å‡ºçš„ tuples æ•°ï¼Œç»™å®šå·¦è¾¹çš„è¾“å…¥æ˜¯å¤§å°ä¸ºcard1ï¼Œå³è¾¹çš„è¾“å…¥æ˜¯å¤§å°ä¸ºcard2ï¼Œä»¥åŠæŒ‡ç¤ºå·¦è¾¹å’Œå³è¾¹ï¼ˆåˆ†åˆ«ï¼‰å­—æ®µæ˜¯å¦å”¯ä¸€ï¼ˆä¸»é”®ï¼‰çš„æ ‡å¿—t1pkeyå’Œt2pkeyã€‚</p>
<p>After implementing these methods, you should be able to pass the unit tests estimateJoinCostTest and estimateJoinCardinality in JoinOptimizerTest.java.</p>
<p>å®ç°è¿™äº›æ–¹æ³•åï¼Œä½ åº”è¯¥èƒ½å¤Ÿé€šè¿‡JoinOptimizerTest.javaä¸­çš„å•å…ƒæµ‹è¯• estimateJoinCostTest å’Œ estimateJoinCardinalityã€‚</p>
<h2 id="23-join-ordering"><a class="header" href="#23-join-ordering">2.3 Join Ordering</a></h2>
<p>Now that you have implemented methods for estimating costs, you will implement the Selinger optimizer. For these methods, joins are expressed as a list of join nodes (e.g., predicates over two tables) as opposed to a list of relations to join as described in class.</p>
<p>ç°åœ¨ä½ å·²ç»å®ç°äº†ä¼°è®¡æˆæœ¬çš„æ–¹æ³•ï¼Œä½ å°†å®ç°Selingerä¼˜åŒ–å™¨ã€‚å¯¹äºè¿™äº›æ–¹æ³•ï¼Œè¿æ¥è¢«è¡¨è¾¾ä¸ºä¸€ä¸ªè¿æ¥èŠ‚ç‚¹çš„åˆ—è¡¨ï¼ˆä¾‹å¦‚ï¼Œå¯¹ä¸¤ä¸ªè¡¨çš„è°“è¯ï¼‰ï¼Œè€Œä¸æ˜¯è¯¾å ‚ä¸Šæè¿°çš„è¿æ¥å…³ç³»çš„åˆ—è¡¨ã€‚</p>
<p>Translating the algorithm given in lecture to the join node list form mentioned above, an outline in pseudocode would be:</p>
<p>å°†è®²åº§ä¸­ç»™å‡ºçš„ç®—æ³•è½¬åŒ–ä¸ºä¸Šè¿°çš„è¿æ¥èŠ‚ç‚¹åˆ—è¡¨å½¢å¼ï¼Œä¼ªä»£ç çš„æ¦‚è¦æ˜¯ï¼šã€‚</p>
<pre><code class="language-java">1. j = set of join nodes
2. for (i in 1...|j|):
3.     for s in {all length i subsets of j}
4.       bestPlan = {}
5.       for s' in {all length d-1 subsets of s}
6.            subplan = optjoin(s')
7.            plan = best way to join (s-s') to subplan
8.            if (cost(plan) &lt; cost(bestPlan))
9.               bestPlan = plan
10.      optjoin(s) = bestPlan
11. return optjoin(j)
</code></pre>
<p>To help you implement this algorithm, we have provided several classes and methods to assist you. First, the method enumerateSubsets(List v, int size) in JoinOptimizer.java will return a set of all of the subsets of v of size size. This method is VERY inefficient for large sets; you can earn extra credit by implementing a more efficient enumerator (hint: consider using an in-place generation algorithm and a lazy iterator (or stream) interface to avoid materializing the entire power set).</p>
<p>ä¸ºäº†å¸®åŠ©ä½ å®ç°è¿™ä¸ªç®—æ³•ï¼Œæˆ‘ä»¬æä¾›äº†å‡ ä¸ªç±»å’Œæ–¹æ³•æ¥å¸®åŠ©ä½ ã€‚é¦–å…ˆï¼ŒJoinOptimizer.javaä¸­çš„enumerateSubsets(List v, int size)æ–¹æ³•å°†è¿”å›ä¸€ä¸ªå¤§å°ä¸ºvçš„æ‰€æœ‰å­é›†çš„é›†åˆã€‚è¿™ä¸ªæ–¹æ³•å¯¹äºå¤§å‹é›†åˆæ¥è¯´æ•ˆç‡éå¸¸ä½ï¼›ä½ å¯ä»¥é€šè¿‡å®ç°ä¸€ä¸ªæ›´æœ‰æ•ˆçš„æšä¸¾å™¨æ¥è·å¾—é¢å¤–çš„åˆ†æ•°ï¼ˆæç¤ºï¼šè€ƒè™‘ä½¿ç”¨åŸåœ°ç”Ÿæˆç®—æ³•å’Œæ‡’æƒ°è¿­ä»£å™¨ï¼ˆæˆ–æµï¼‰æ¥å£æ¥é¿å…ç‰©åŒ–æ•´ä¸ªå¹‚é›†ï¼‰ã€‚</p>
<p>Second, we have provided the method:</p>
<p>ç¬¬äºŒï¼Œæˆ‘ä»¬æä¾›äº†æ–¹æ³•ã€‚</p>
<pre><code class="language-java">    private CostCard computeCostAndCardOfSubplan(Map&lt;String, TableStats&gt; stats, 
                                                Map&lt;String, Double&gt; filterSelectivities, 
                                                LogicalJoinNode joinToRemove,  
                                                Set&lt;LogicalJoinNode&gt; joinSet,
                                                double bestCostSoFar,
                                                PlanCache pc) 
</code></pre>
<p>Given a subset of joins (joinSet), and a join to remove from this set (joinToRemove), this method computes the best way to join joinToRemove to joinSet - {joinToRemove}. It returns this best method in a CostCard object, which includes the cost, cardinality, and best join ordering (as a list). computeCostAndCardOfSubplan may return null, if no plan can be found (because, for example, there is no left-deep join that is possible), or if the cost of all plans is greater than the bestCostSoFar argument. The method uses a cache of previous joins called pc (optjoin in the psuedocode above) to quickly lookup the fastest way to join joinSet - {joinToRemove}. The other arguments (stats and filterSelectivities) are passed into the orderJoins method that you must implement as a part of Exercise 4, and are explained below. This method essentially performs lines 6--8 of the psuedocode described earlier.</p>
<p>ç»™å‡ºä¸€ä¸ªè¿æ¥çš„å­é›†ï¼ˆjoinSetï¼‰ï¼Œä»¥åŠä¸€ä¸ªè¦ä»è¿™ä¸ªå­é›†ä¸­ç§»é™¤çš„è¿æ¥ï¼ˆjoinToRemoveï¼‰ï¼Œè¿™ä¸ªæ–¹æ³•è®¡ç®—å‡ºå°†joinToRemoveè¿æ¥åˆ°joinSetçš„æœ€ä½³æ–¹æ³•--{joinToRemove}ã€‚å®ƒåœ¨ä¸€ä¸ªCostCardå¯¹è±¡ä¸­è¿”å›è¿™ä¸ªæœ€ä½³æ–¹æ³•ï¼Œå…¶ä¸­åŒ…æ‹¬æˆæœ¬ã€cardinalityå’Œæœ€ä½³è¿æ¥é¡ºåºï¼ˆä½œä¸ºä¸€ä¸ªåˆ—è¡¨ï¼‰ã€‚å¦‚æœæ‰¾ä¸åˆ°è®¡åˆ’ï¼ˆå› ä¸ºï¼Œä¾‹å¦‚ï¼Œæ²¡æœ‰å¯èƒ½çš„å·¦æ·±è¿æ¥ï¼‰ï¼Œæˆ–è€…å¦‚æœæ‰€æœ‰è®¡åˆ’çš„æˆæœ¬éƒ½å¤§äºbestCostSoFarå‚æ•°ï¼ŒcomputeCostAndCardOfSubplanå¯èƒ½è¿”å›nullã€‚è¯¥æ–¹æ³•ä½¿ç”¨äº†ä¸€ä¸ªå«åšpcï¼ˆä¸Šé¢çš„psuedocodeä¸­çš„optjoinï¼‰çš„å…ˆå‰è¿æ¥çš„ç¼“å­˜æ¥å¿«é€ŸæŸ¥æ‰¾joinSetçš„æœ€å¿«æ–¹å¼--{joinToRemove}ã€‚å…¶ä»–å‚æ•°ï¼ˆstatså’ŒfilterSelectivitiesï¼‰è¢«ä¼ é€’åˆ°ä½ å¿…é¡»å®ç°çš„orderJoinsæ–¹æ³•ä¸­ï¼Œä½œä¸ºç»ƒä¹ 4çš„ä¸€éƒ¨åˆ†ï¼Œä¸‹é¢ä¼šæœ‰è§£é‡Šã€‚è¿™ä¸ªæ–¹æ³•åŸºæœ¬ä¸Šæ˜¯æ‰§è¡Œå‰é¢æè¿°çš„å‡ä»£ç çš„ç¬¬6-8è¡Œã€‚</p>
<p>Third, we have provided the method:</p>
<p>ç¬¬ä¸‰ï¼Œæˆ‘ä»¬æä¾›äº†æ–¹æ³•ã€‚</p>
<pre><code class="language-java">    private void printJoins(List&lt;LogicalJoinNode&gt; js, 
                           PlanCache pc,
                           Map&lt;String, TableStats&gt; stats,
                           Map&lt;String, Double&gt; selectivities)
</code></pre>
<p>This method can be used to display a graphical representation of a join plan (when the &quot;explain&quot; flag is set via the &quot;-explain&quot; option to the optimizer, for example).</p>
<p>è¿™ç§æ–¹æ³•å¯ä»¥ç”¨æ¥æ˜¾ç¤ºè¿æ¥è®¡åˆ’çš„å›¾å½¢è¡¨ç¤ºï¼ˆä¾‹å¦‚ï¼Œå½“é€šè¿‡ä¼˜åŒ–å™¨çš„&quot;-explain &quot;é€‰é¡¹è®¾ç½® &quot;explain &quot;æ ‡å¿—æ—¶ï¼‰ã€‚</p>
<p>Fourth, we have provided a class PlanCache that can be used to cache the best way to join a subset of the joins considered so far in your implementation of Selinger (an instance of this class is needed to use computeCostAndCardOfSubplan).</p>
<p>ç¬¬å››ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªPlanCacheç±»ï¼Œå¯ä»¥ç”¨æ¥ç¼“å­˜åˆ°ç›®å‰ä¸ºæ­¢åœ¨ä½ çš„Selingerå®ç°ä¸­æ‰€è€ƒè™‘çš„è¿æ¥å­é›†çš„æœ€ä½³æ–¹å¼ï¼ˆä½¿ç”¨computeCostAndCardOfSubplanéœ€è¦è¿™ä¸ªç±»çš„ä¸€ä¸ªå®ä¾‹ï¼‰ã€‚</p>
<h2 id="exercise-4-join-ordering"><a class="header" href="#exercise-4-join-ordering">Exercise 4: Join Ordering</a></h2>
<p>In JoinOptimizer.java, implement the method:</p>
<p>åœ¨JoinOptimizer.javaä¸­ï¼Œå®ç°è¿™ä¸ªæ–¹æ³•ã€‚</p>
<pre><code class="language-java">  List&lt;LogicalJoinNode&gt; orderJoins(Map&lt;String, TableStats&gt; stats, 
                   Map&lt;String, Double&gt; filterSelectivities,  
                   boolean explain)
</code></pre>
<p>This method should operate on the joins class member, returning a new List that specifies the order in which joins should be done. Item 0 of this list indicates the left-most, bottom-most join in a left-deep plan. Adjacent joins in the returned list should share at least one field to ensure the plan is left-deep. Here stats is an object that lets you find the TableStats for a given table name that appears in the FROM list of the query. filterSelectivities allows you to find the selectivity of any predicates over a table; it is guaranteed to have one entry per table name in the FROM list. Finally, explain specifies that you should output a representation of the join order for informational purposes.</p>
<p>è¿™ä¸ªæ–¹æ³•åº”è¯¥åœ¨joinsç±»æˆå‘˜ä¸Šæ“ä½œï¼Œè¿”å›ä¸€ä¸ªæ–°çš„Listï¼Œè¿™ä¸ªListæŒ‡å®šäº†åº”è¯¥è¿›è¡Œçš„è¿æ¥çš„é¡ºåºã€‚è¿™ä¸ªåˆ—è¡¨ä¸­çš„ç¬¬0é¡¹è¡¨ç¤ºå·¦æ·±è®¡åˆ’ä¸­æœ€å·¦ã€æœ€åº•çš„è¿æ¥ã€‚è¿”å›çš„åˆ—è¡¨ä¸­ç›¸é‚»çš„è¿æ¥åº”è¯¥è‡³å°‘å…±äº«ä¸€ä¸ªå­—æ®µï¼Œä»¥ç¡®ä¿è®¡åˆ’æ˜¯å·¦æ·±çš„ã€‚è¿™é‡Œstatsæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè®©ä½ æ‰¾åˆ°å‡ºç°åœ¨æŸ¥è¯¢çš„FROMåˆ—è¡¨ä¸­çš„ç»™å®šè¡¨åçš„TableStatsã€‚ filterSelectivitiesè®©ä½ æ‰¾åˆ°è¡¨çš„ä»»ä½•è°“è¯çš„é€‰æ‹©æ€§ï¼›å®ƒä¿è¯åœ¨FROMåˆ—è¡¨ä¸­çš„æ¯ä¸ªè¡¨åæœ‰ä¸€ä¸ªæ¡ç›®ã€‚æœ€åï¼ŒexplainæŒ‡å®šäº†ä½ åº”è¯¥è¾“å‡ºä¸€ä¸ªè¿æ¥é¡ºåºçš„è¡¨ç¤ºï¼Œä»¥ä¾›å‚è€ƒã€‚</p>
<p>You may wish to use the helper methods and classes described above to assist in your implementation. Roughly, your implementation should follow the psuedocode above, looping through subset sizes, subsets, and sub-plans of subsets, calling computeCostAndCardOfSubplan and building a PlanCache object that stores the minimal-cost way to perform each subset join.</p>
<p>ä½ å¯èƒ½å¸Œæœ›ä½¿ç”¨ä¸Šé¢æè¿°çš„è¾…åŠ©æ–¹æ³•å’Œç±»æ¥å¸®åŠ©ä½ å®ç°ã€‚å¤§è‡´ä¸Šï¼Œä½ çš„å®ç°åº”è¯¥éµå¾ªä¸Šé¢çš„å‡è®¾ä»£ç ï¼Œé€šè¿‡å­é›†å¤§å°ã€å­é›†å’Œå­é›†çš„å­è®¡åˆ’è¿›è¡Œå¾ªç¯ï¼Œè°ƒç”¨computeCostAndCardOfSubplanå¹¶å»ºç«‹ä¸€ä¸ªPlanCacheå¯¹è±¡æ¥å­˜å‚¨æ‰§è¡Œæ¯ä¸ªå­é›†è¿æ¥çš„æœ€å°æˆæœ¬æ–¹å¼ã€‚</p>
<p>After implementing this method, you should be able to pass all the unit tests in JoinOptimizerTest. You should also pass the system test QueryTest.</p>
<p>å®ç°è¿™ä¸ªæ–¹æ³•åï¼Œä½ åº”è¯¥èƒ½å¤Ÿé€šè¿‡JoinOptimizerTestçš„æ‰€æœ‰å•å…ƒæµ‹è¯•ã€‚ä½ è¿˜åº”è¯¥é€šè¿‡ç³»ç»Ÿæµ‹è¯•QueryTestã€‚</p>
<h1 id="24-extra-credit"><a class="header" href="#24-extra-credit">2.4 Extra Credit</a></h1>
<p>In this section, we describe several optional excercises that you may implement for extra credit. These are less well defined than the previous exercises but give you a chance to show off your mastery of query optimization! Please clearly mark which ones you have chosen to complete in your report, and briefly explain your implementation and present your results (benchmark numbers, experience reports, etc.)</p>
<p>åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬æè¿°äº†å‡ ä¸ªå¯é€‰çš„ç»ƒä¹ ï¼Œä½ å¯ä»¥å®æ–½è¿™äº›ç»ƒä¹ æ¥è·å¾—é¢å¤–çš„åˆ†æ•°ã€‚è¿™äº›ç»ƒä¹ æ²¡æœ‰å‰é¢çš„ç»ƒä¹ é‚£ä¹ˆæ˜ç¡®ï¼Œä½†å¯ä»¥è®©ä½ æœ‰æœºä¼šå±•ç¤ºä½ å¯¹æŸ¥è¯¢ä¼˜åŒ–çš„æŒæ¡ç¨‹åº¦ è¯·åœ¨ä½ çš„æŠ¥å‘Šä¸­æ¸…æ¥šåœ°æ ‡å‡ºä½ é€‰æ‹©å®Œæˆçš„ç»ƒä¹ ï¼Œå¹¶ç®€è¦åœ°è§£é‡Šä½ çš„æ‰§è¡Œæƒ…å†µå’Œä»‹ç»ä½ çš„ç»“æœï¼ˆåŸºå‡†æ•°å­—ã€ç»éªŒæŠ¥å‘Šç­‰ï¼‰ã€‚</p>
<p>Bonus Exercises. Each of these bonuses is worth up to 5% extra credit:</p>
<p>å¥–åŠ±ç»ƒä¹ ã€‚è¿™äº›å¥–é‡‘ä¸­çš„æ¯ä¸€ä¸ªéƒ½ä»·å€¼é«˜è¾¾5%çš„é¢å¤–ä¿¡ç”¨ã€‚</p>
<p>Add code to perform more advanced join cardinality estimation. Rather than using simple heuristics to estimate join cardinality, devise a more sophisticated algorithm.</p>
<p>æ·»åŠ ä»£ç ä»¥æ‰§è¡Œæ›´é«˜çº§çš„è¿æ¥å¿ƒç‡ä¼°è®¡ã€‚ä¸å…¶ä½¿ç”¨ç®€å•çš„å¯å‘å¼æ–¹æ³•æ¥ä¼°è®¡è¿æ¥çš„cardinalityï¼Œä¸å¦‚è®¾è®¡ä¸€ä¸ªæ›´å¤æ‚çš„ç®—æ³•ã€‚</p>
<p>One option is to use joint histograms between every pair of attributes a and b in every pair of tables t1 and t2. The idea is to create buckets of a, and for each bucket A of a, create a histogram of b values that co-occur with a values in A.</p>
<p>ä¸€ç§é€‰æ‹©æ˜¯åœ¨æ¯å¯¹è¡¨t1å’Œt2ä¸­çš„æ¯å¯¹å±æ€§aå’Œbä¹‹é—´ä½¿ç”¨è”åˆç›´æ–¹å›¾ã€‚è¿™ä¸ªæƒ³æ³•æ˜¯åˆ›å»ºaçš„æ¡¶ï¼Œå¯¹äºaçš„æ¯ä¸ªæ¡¶Aï¼Œåˆ›å»ºä¸€ä¸ªä¸Aä¸­aå€¼å…±åŒå‡ºç°çš„bå€¼çš„ç›´æ–¹å›¾ã€‚</p>
<p>Another way to estimate the cardinality of a join is to assume that each value in the smaller table has a matching value in the larger table. Then the formula for the join selectivity would be: 1/(Max(num-distinct(t1, column1), num-distinct(t2, column2))). Here, column1 and column2 are the join attributes. The cardinality of the join is then the product of the cardinalities of t1 and t2 times the selectivity.</p>
<p>å¦ä¸€ç§ä¼°è®¡è¿æ¥çš„cardinalityçš„æ–¹æ³•æ˜¯å‡è®¾å°è¡¨ä¸­çš„æ¯ä¸ªå€¼åœ¨å¤§è¡¨ä¸­éƒ½æœ‰ä¸€ä¸ªåŒ¹é…çš„å€¼ã€‚é‚£ä¹ˆè¿æ¥é€‰æ‹©æ€§çš„å…¬å¼å°†æ˜¯ã€‚1/(Max(num-distinct(t1, column1), num-distinct(t2, column2))ï¼‰ã€‚è¿™é‡Œï¼Œåˆ—1å’Œåˆ—2æ˜¯è¿æ¥å±æ€§ã€‚è¿æ¥çš„cardinalityæ˜¯t1å’Œt2çš„cardinalityä¹˜ä»¥é€‰æ‹©æ€§çš„äº§ç‰©ã€‚</p>
<p>Improved subset iterator. Our implementation of enumerateSubsets is quite inefficient, because it creates a large number of Java objects on each invocation.</p>
<p>æ”¹è¿›å­é›†è¿­ä»£å™¨ã€‚æˆ‘ä»¬å¯¹enumerateSubsetsçš„å®ç°æ˜¯ç›¸å½“ä½æ•ˆçš„ï¼Œå› ä¸ºå®ƒåœ¨æ¯æ¬¡è°ƒç”¨æ—¶éƒ½ä¼šåˆ›å»ºå¤§é‡çš„Javaå¯¹è±¡ã€‚</p>
<p>In this bonus exercise, you would improve the performance of enumerateSubsets so that your system could perform query optimization on plans with 20 or more joins (currently such plans takes minutes or hours to compute).</p>
<p>åœ¨è¿™ä¸ªå¥–åŠ±ç»ƒä¹ ä¸­ï¼Œä½ å°†æé«˜enumerateSubsetsçš„æ€§èƒ½ï¼Œè¿™æ ·ä½ çš„ç³»ç»Ÿå°±å¯ä»¥å¯¹æœ‰20ä¸ªæˆ–æ›´å¤šè¿æ¥çš„è®¡åˆ’è¿›è¡ŒæŸ¥è¯¢ä¼˜åŒ–ï¼ˆç›®å‰è¿™æ ·çš„è®¡åˆ’éœ€è¦å‡ åˆ†é’Ÿæˆ–å‡ å°æ—¶æ¥è®¡ç®—ï¼‰ã€‚</p>
<p>A cost model that accounts for caching. The methods to estimate scan and join cost do not account for caching in the buffer pool. You should extend the cost model to account for caching effects. This is tricky because multiple joins are running simultaneously due to the iterator model, and so it may be hard to predict how much memory each will have access to using the simple buffer pool we have implemented in previous labs.</p>
<p>ä¸€ä¸ªè€ƒè™‘åˆ°ç¼“å­˜çš„æˆæœ¬æ¨¡å‹ã€‚ä¼°è®¡æ‰«æå’Œè¿æ¥æˆæœ¬çš„æ–¹æ³•æ²¡æœ‰è€ƒè™‘åˆ°ç¼“å†²æ± ä¸­çš„ç¼“å­˜ã€‚ä½ åº”è¯¥æ‰©å±•æˆæœ¬æ¨¡å‹ä»¥è€ƒè™‘åˆ°ç¼“å­˜æ•ˆåº”ã€‚è¿™å¾ˆæ£˜æ‰‹ï¼Œå› ä¸ºç”±äºè¿­ä»£å™¨æ¨¡å‹ï¼Œå¤šä¸ªè¿æ¥æ˜¯åŒæ—¶è¿è¡Œçš„ï¼Œæ‰€ä»¥å¯èƒ½å¾ˆéš¾é¢„æµ‹ä½¿ç”¨æˆ‘ä»¬åœ¨ä»¥å‰çš„å®éªŒä¸­å®ç°çš„ç®€å•ç¼“å†²æ± ï¼Œæ¯ä¸ªäººå¯ä»¥è·å¾—å¤šå°‘å†…å­˜ã€‚</p>
<p>Improved join algorithms and algorithm selection. Our current cost estimation and join operator selection algorithms (see instantiateJoin() in JoinOptimizer.java) only consider nested loops joins. Extend these methods to use one or more additional join algorithms (for example, some form of in memory hashing using a HashMap).</p>
<p>æ”¹è¿›çš„è¿æ¥ç®—æ³•å’Œç®—æ³•é€‰æ‹©ã€‚æˆ‘ä»¬ç›®å‰çš„æˆæœ¬ä¼°ç®—å’Œè¿æ¥è¿ç®—ç¬¦é€‰æ‹©ç®—æ³•ï¼ˆè§JoinOptimizer.javaä¸­çš„instantiateJoin()ï¼‰åªè€ƒè™‘åµŒå¥—å¾ªç¯çš„è¿æ¥ã€‚æ‰©å±•è¿™äº›æ–¹æ³•ä»¥ä½¿ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªé¢å¤–çš„è¿æ¥ç®—æ³•ï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨HashMapçš„æŸç§å½¢å¼çš„å†…å­˜æ•£åˆ—ï¼‰ã€‚</p>
<p>Bushy plans. Improve the provided orderJoins() and other helper methods to generate bushy joins. Our query plan generation and visualization algorithms are perfectly capable of handling bushy plans; for example, if orderJoins() returns the list (t1 join t2 ; t3 join t4 ; t2 join t3), this will correspond to a bushy plan with the (t2 join t3) node at the top.</p>
<p>å¿™ç¢Œçš„è®¡åˆ’ã€‚æ”¹è¿›æ‰€æä¾›çš„orderJoins()å’Œå…¶ä»–è¾…åŠ©æ–¹æ³•ï¼Œä»¥ç”Ÿæˆbushy joinsã€‚æˆ‘ä»¬çš„æŸ¥è¯¢è®¡åˆ’ç”Ÿæˆå’Œå¯è§†åŒ–ç®—æ³•å®Œå…¨èƒ½å¤Ÿå¤„ç†ç¹å¿™çš„è®¡åˆ’ï¼›ä¾‹å¦‚ï¼Œå¦‚æœorderJoins()è¿”å›åˆ—è¡¨(t1 join t2; t3 join t4; t2 join t3)ï¼Œè¿™å°†å¯¹åº”äºä¸€ä¸ªç¹å¿™çš„è®¡åˆ’ï¼Œ(t2 join t3)èŠ‚ç‚¹åœ¨é¡¶éƒ¨ã€‚</p>
<p>You have now completed this lab. Good work!</p>
<p>ä½ ç°åœ¨å·²ç»å®Œæˆäº†è¿™ä¸ªå®éªŒã€‚å¹²å¾—å¥½!</p>
<h2 id="3-logistics"><a class="header" href="#3-logistics">3. Logistics</a></h2>
<p>You must submit your code (see below) as well as a short (2 pages, maximum) writeup describing your approach. This writeup should:</p>
<p>ä½ å¿…é¡»æäº¤ä½ çš„ä»£ç ï¼ˆè§ä¸‹æ–‡ï¼‰ä»¥åŠæè¿°ä½ çš„æ–¹æ³•çš„ç®€çŸ­ï¼ˆ2é¡µï¼Œæœ€å¤šï¼‰çš„æ–‡ç« ã€‚è¿™ç¯‡æŠ¥å‘Šåº”è¯¥</p>
<p>Describe any design decisions you made, including methods for selectivity estimation, join ordering, as well as any of the bonus exercises you chose to implement and how you implemented them (for each bonus exercise you may submit up to 1 additional page).
Discuss and justify any changes you made to the API.
Describe any missing or incomplete elements of your code.
Describe how long you spent on the lab, and whether there was anything you found particularly difficult or confusing.
Description of any extra credit implementation you have done.</p>
<p>æè¿°ä½ æ‰€åšçš„ä»»ä½•è®¾è®¡å†³å®šï¼ŒåŒ…æ‹¬é€‰æ‹©æ€§ä¼°è®¡çš„æ–¹æ³•ï¼Œè¿æ¥æ’åºï¼Œä»¥åŠä½ é€‰æ‹©å®ç°çš„ä»»ä½•å¥–åŠ±ç»ƒä¹ å’Œä½ å¦‚ä½•å®ç°å®ƒä»¬ï¼ˆå¯¹äºæ¯ä¸ªå¥–åŠ±ç»ƒä¹ ï¼Œä½ å¯ä»¥æäº¤å¤šè¾¾1é¡µçš„é¢å¤–å†…å®¹ï¼‰ã€‚
è®¨è®ºå¹¶è¯æ˜ä½ å¯¹APIæ‰€ä½œçš„ä»»ä½•ä¿®æ”¹ã€‚
æè¿°ä½ çš„ä»£ç ä¸­ä»»ä½•ç¼ºå¤±æˆ–ä¸å®Œæ•´çš„å…ƒç´ ã€‚
æè¿°ä½ èŠ±äº†å¤šé•¿æ—¶é—´åšè¿™ä¸ªå®éªŒï¼Œä»¥åŠæ˜¯å¦æœ‰ä»»ä½•ä½ è®¤ä¸ºç‰¹åˆ«å›°éš¾æˆ–å›°æƒ‘çš„åœ°æ–¹ã€‚
æè¿°ä½ æ‰€åšçš„ä»»ä½•é¢å¤–åŠŸåŠ³çš„å®ç°ã€‚</p>
<h2 id="31-collaboration"><a class="header" href="#31-collaboration">3.1. Collaboration</a></h2>
<p>This lab should be manageable for a single person, but if you prefer to work with a partner, this is also OK. Larger groups are not allowed. Please indicate clearly who you worked with, if anyone, on your writeup.</p>
<p>è¿™ä¸ªå®å®¤å¯¹ä¸€ä¸ªäººæ¥è¯´åº”è¯¥æ˜¯å¯ä»¥åº”ä»˜çš„ï¼Œä½†å¦‚æœä½ å–œæ¬¢å’Œä¸€ä¸ªä¼™ä¼´ä¸€èµ·å·¥ä½œï¼Œè¿™ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚ä¸å…è®¸æœ‰è¾ƒå¤§çš„å›¢ä½“ã€‚å¦‚æœæœ‰çš„è¯ï¼Œè¯·åœ¨ä½ çš„æŠ¥å‘Šä¸­æ˜ç¡®æŒ‡å‡ºä½ å’Œè°ä¸€èµ·å·¥ä½œã€‚</p>
<h2 id="32-submitting-your-assignment"><a class="header" href="#32-submitting-your-assignment">3.2. Submitting your assignment</a></h2>
<p>We will be using gradescope to autograde all programming assignments. You should have all been invited to the class instance; if not, please let us know and we can help you set up. You may submit your code multiple times before the deadline; we will use the latest version as determined by gradescope. Place the write-up in a file called lab3-writeup.txt with your submission. You also need to explicitly add any other files you create, such as new *.java files.</p>
<p>æˆ‘ä»¬å°†ä½¿ç”¨gradescopeå¯¹æ‰€æœ‰ç¼–ç¨‹ä½œä¸šè¿›è¡Œè‡ªåŠ¨è¯„åˆ†ã€‚ä½ ä»¬åº”è¯¥éƒ½è¢«é‚€è¯·åˆ°ç­çº§å®ä¾‹ä¸­ï¼›å¦‚æœæ²¡æœ‰ï¼Œè¯·å‘Šè¯‰æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¯ä»¥å¸®åŠ©ä½ ä»¬è®¾ç½®ã€‚ä½ å¯ä»¥åœ¨æˆªæ­¢æ—¥æœŸå‰å¤šæ¬¡æäº¤ä½ çš„ä»£ç ï¼›æˆ‘ä»¬å°†ä½¿ç”¨ç”±gradescopeç¡®å®šçš„æœ€æ–°ç‰ˆæœ¬ã€‚æŠŠå†™å¥½çš„ä¸œè¥¿æ”¾åœ¨ä¸€ä¸ªå«lab3-writeup.txtçš„æ–‡ä»¶é‡Œï¼Œå’Œä½ çš„æäº¤ä¸€èµ·ã€‚ä½ è¿˜éœ€è¦æ˜ç¡®åœ°æ·»åŠ ä½ åˆ›å»ºçš„ä»»ä½•å…¶ä»–æ–‡ä»¶ï¼Œå¦‚æ–°çš„*.javaæ–‡ä»¶ã€‚</p>
<p>The easiest way to submit to gradescope is with .zip files containing your code. On Linux/MacOS, you can do so by running the following command:</p>
<p>å‘ gradescope æäº¤çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä½¿ç”¨åŒ…å«ä½ çš„ä»£ç çš„ .zip æ–‡ä»¶ã€‚åœ¨Linux/MacOSä¸Šï¼Œä½ å¯ä»¥é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ¥å®ç°ã€‚</p>
<pre><code>$ zip -r submission.zip src/ lab3-writeup.txt
</code></pre>
<h2 id="33-submitting-a-bug"><a class="header" href="#33-submitting-a-bug">3.3. Submitting a bug</a></h2>
<p>SimpleDB is a relatively complex piece of code. It is very possible you are going to find bugs, inconsistencies, and bad, outdated, or incorrect documentation, etc.</p>
<p>SimpleDBæ˜¯ä¸€ä¸ªç›¸å¯¹å¤æ‚çš„ä»£ç ã€‚ä½ å¾ˆå¯èƒ½ä¼šå‘ç°é”™è¯¯ã€ä¸ä¸€è‡´ï¼Œä»¥åŠç³Ÿç³•çš„ã€è¿‡æ—¶çš„æˆ–ä¸æ­£ç¡®çš„æ–‡æ¡£ç­‰ç­‰ã€‚</p>
<p>We ask you, therefore, to do this lab with an adventurous mindset. Don't get mad if something is not clear, or even wrong; rather, try to figure it out yourself or send us a friendly email.</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬è¦æ±‚ä½ ä»¥ä¸€ç§å†’é™©çš„å¿ƒæ€æ¥åšè¿™ä¸ªå®å®¤ã€‚å¦‚æœæœ‰ä¸æ¸…æ¥šçš„åœ°æ–¹ï¼Œç”šè‡³æ˜¯é”™è¯¯çš„åœ°æ–¹ï¼Œä¸è¦ç”Ÿæ°”ï¼›è€Œæ˜¯è¦è‡ªå·±å°è¯•å»å¼„æ¸…æ¥šï¼Œæˆ–è€…ç»™æˆ‘ä»¬å‘ä¸€å°å‹å¥½çš„ç”µå­é‚®ä»¶ã€‚</p>
<p>Please submit (friendly!) bug reports to 6.830-staff@mit.edu. When you do, please try to include:</p>
<p>è¯·æäº¤ï¼ˆå‹å¥½çš„ï¼ï¼‰é”™è¯¯æŠ¥å‘Šåˆ°6.830-staff@mit.eduã€‚å½“ä½ è¿™æ ·åšæ—¶ï¼Œè¯·å°½é‡åŒ…æ‹¬ã€‚</p>
<p>A description of the bug.
A .java file we can drop in the test/simpledb directory, compile, and run.
A .txt file with the data that reproduces the bug. We should be able to convert it to a .dat file using HeapFileEncoder.
You can also post on the class page on Piazza if you feel you have run into a bug.</p>
<p>ä¸€ä¸ªå…³äºè¯¥é”™è¯¯çš„æè¿°ã€‚
ä¸€ä¸ª.javaæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒæ”¾åˆ°test/simpledbç›®å½•ä¸­ï¼Œç¼–è¯‘å¹¶è¿è¡Œã€‚
ä¸€ä¸ªåŒ…å«å†ç°è¯¥é”™è¯¯çš„æ•°æ®çš„.txtæ–‡ä»¶ã€‚æˆ‘ä»¬åº”è¯¥èƒ½å¤Ÿç”¨HeapFileEncoderå°†å…¶è½¬æ¢ä¸º.datæ–‡ä»¶ã€‚
å¦‚æœä½ è§‰å¾—ä½ é‡åˆ°äº†ä¸€ä¸ªbugï¼Œä½ ä¹Ÿå¯ä»¥åœ¨Piazzaçš„ç±»é¡µé¢ä¸Šå‘å¸–ã€‚</p>
<h2 id="34-grading"><a class="header" href="#34-grading">3.4 Grading</a></h2>
<p>75% of your grade will be based on whether or not your code passes the system test suite we will run over it. These tests will be a superset of the tests we have provided. Before handing in your code, you should make sure it produces no errors (passes all of the tests) from both ant test and ant systemtest.</p>
<p>ä½ çš„æˆç»©çš„75%å°†åŸºäºä½ çš„ä»£ç æ˜¯å¦é€šè¿‡æˆ‘ä»¬å°†å¯¹å…¶è¿›è¡Œçš„ç³»ç»Ÿæµ‹è¯•å¥—ä»¶ã€‚è¿™äº›æµ‹è¯•å°†æ˜¯æˆ‘ä»¬æä¾›çš„æµ‹è¯•çš„ä¸€ä¸ªè¶…é›†ã€‚åœ¨äº¤å‡ºä½ çš„ä»£ç ä¹‹å‰ï¼Œä½ åº”è¯¥ç¡®ä¿å®ƒåœ¨ant testå’Œant systemtestä¸­æ²¡æœ‰äº§ç”Ÿé”™è¯¯ï¼ˆé€šè¿‡æ‰€æœ‰çš„æµ‹è¯•ï¼‰ã€‚</p>
<p>Important: before testing, gradescope will replace your build.xml, HeapFileEncoder.java and the entire contents of the test directory with our version of these files. This means you cannot change the format of .dat files! You should also be careful changing our APIs. You should test that your code compiles the unmodified tests.</p>
<p>é‡è¦çš„æ˜¯ï¼šåœ¨æµ‹è¯•ä¹‹å‰ï¼Œgradescope ä¼šç”¨æˆ‘ä»¬çš„ç‰ˆæœ¬æ›¿æ¢ä½ çš„ build.xmlã€HeapFileEncoder.java ä»¥åŠæµ‹è¯•ç›®å½•ä¸­çš„å…¨éƒ¨å†…å®¹ã€‚è¿™æ„å‘³ç€ä½ ä¸èƒ½æ”¹å˜.datæ–‡ä»¶çš„æ ¼å¼! ä½ ä¹Ÿåº”è¯¥å°å¿ƒæ”¹å˜æˆ‘ä»¬çš„APIã€‚ä½ åº”è¯¥æµ‹è¯•ä½ çš„ä»£ç æ˜¯å¦ç¼–è¯‘äº†æœªä¿®æ”¹çš„æµ‹è¯•ã€‚</p>
<p>You should get immediate feedback and error outputs for failed tests (if any) from gradescope after submission. The score given will be your grade for the autograded portion of the assignment. An additional 25% of your grade will be based on the quality of your writeup and our subjective evaluation of your code. This part will also be published on gradescope after we finish grading your assignment.</p>
<p>åœ¨æäº¤åï¼Œä½ åº”è¯¥ä» gradescope å¾—åˆ°å³æ—¶åé¦ˆå’Œå¤±è´¥æµ‹è¯•çš„é”™è¯¯è¾“å‡ºï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ã€‚ç»™å‡ºçš„åˆ†æ•°å°†æ˜¯ä½ åœ¨ä½œä¸šçš„è‡ªåŠ¨è¯„åˆ†éƒ¨åˆ†çš„æˆç»©ã€‚å¦å¤–25%çš„åˆ†æ•°å°†åŸºäºä½ çš„å†™ä½œè´¨é‡å’Œæˆ‘ä»¬å¯¹ä½ ä»£ç çš„ä¸»è§‚è¯„ä»·ã€‚åœ¨æˆ‘ä»¬ç»™ä½ çš„ä½œä¸šè¯„åˆ†åï¼Œè¿™éƒ¨åˆ†ä¹Ÿå°†åœ¨ gradescope ä¸Šå…¬å¸ƒã€‚</p>
<p>We had a lot of fun designing this assignment, and we hope you enjoy hacking on it!</p>
<p>æˆ‘ä»¬åœ¨è®¾è®¡è¿™é¡¹ä½œä¸šæ—¶éå¸¸æœ‰è¶£ï¼Œæˆ‘ä»¬å¸Œæœ›ä½ èƒ½äº«å—åˆ°é»‘å®¢çš„ä¹è¶£!</p>

                    <div id="giscus-container"></div>
                </main>

                <nav class="nav-wrapper" aria-label="Page navigation">
                    <!-- Mobile navigation buttons -->
                    <a rel="prev" href="../../6.830/cn/3-lab2.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../../6.830/cn/5-lab4.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>

                    <div style="clear: both"></div>
                </nav>
            </div>
        </div>

        <nav class="nav-wide-wrapper" aria-label="Page navigation">
            <a rel="prev" href="../../6.830/cn/3-lab2.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                <i class="fa fa-angle-left"></i>
            </a>

            <a rel="next" href="../../6.830/cn/5-lab4.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                <i class="fa fa-angle-right"></i>
            </a>
        </nav>

    </div>




    <script type="text/javascript">
        window.playground_copyable = true;
    </script>

    <script src="../../ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../editor.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../mode-rust.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../theme-dawn.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../theme-tomorrow_night.js" type="text/javascript" charset="utf-8"></script>

    <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>

    <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../book.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" charset="utf-8">
        var pagePath = "6.830/cn/4-lab3.md"
    </script>


    <!-- Custom JS scripts -->


</body>
</html>