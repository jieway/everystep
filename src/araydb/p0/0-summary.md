# 简介

LevelDB 网上的总结已经有很多了，但草草浏览一遍总感觉不扎实。因此想深入研究一下 LevelDB。LevelDB 最初被开发和发布（大约在 2011 年左右）时，C++11 标准刚刚发布，许多新特性还没有被广泛采用，于是便产生了这个系列——使用现代 C++ 重写 LevelDB。

LevelDB 是一个高性能的键值存储库，由 Google 的 Jeff Dean 和 Sanjay Ghemawat 开发。它是在 BigTable 的一些概念基础上开发的，特别是在处理非结构化数据方面。LevelDB 首次公开发布于 2011 年，作为一个开源项目在 Google Code 上托管。它是用 C++ 编写的，并且专注于高性能、灵活性和轻量级的设计。

LevelDB 主要设计用于高速读写操作，并且特别优化了随机写入性能。它使用了日志结构合并树（Log-Structured Merge-Tree，LSM-Tree）作为其核心数据结构，以实现高效的数据存储和检索。LevelDB 被广泛用于多种系统和应用中，包括 Chrome 浏览器（作为 IndexedDB 的后端存储）和多个开源项目。它对后续的键值存储系统产生了影响，启发了类似的数据库系统，如 RocksDB（由 Facebook 开发，基于 LevelDB 但进行了大量优化和扩展）。

总的来说，LevelDB 的出现标志着现代键值存储技术的一个重要发展，它的设计理念和实现对后续许多数据库和存储系统的发展产生了深远的影响。

## 组成部分


1. **存储引擎（Storage Engine）**:
   - **MemTable**：内存中的数据结构，用于快速写入和临时存储。
   - **SSTable（Sorted Strings Table）**：持久化存储结构，存储排序后的键值对。
   - **日志（Log）**：用于记录所有写操作，以便于系统故障后的数据恢复。

2. **合并和压缩（Compaction and Compression）**:
   - **压缩**：LevelDB 通过压缩和整理重叠的 SSTables 来优化存储空间和提高读取性能。
   - **版本控制**：管理数据的不同版本，支持快照功能。

3. **索引和查询（Indexing and Querying）**:
   - **布隆过滤器（Bloom Filter）**：一种空间效率高但存在一定误判率的数据结构，用于快速检查一个键是否存在。
   - **索引**：SSTable 包含索引，用于快速定位键值对。

4. **API 和接口（API and Interface）**:
   - **读写操作**：基本的 Get、Put、Delete 操作。
   - **迭代器**：用于遍历键值对。
   - **快照**：提供数据库状态的快照，用于读取一致性视图。

5. **缓存机制（Caching）**:
   - **块缓存（Block Cache）**：用于缓存频繁访问的数据，以减少磁盘读取。
   - **内存管理**：合理管理内存使用，提高整体性能。

6. **并发和同步（Concurrency and Synchronization）**:
   - **锁机制**：确保数据的一致性。
   - **多线程**：通过多线程提高性能，特别是在合并和压缩操作中。

7. **错误处理和日志（Error Handling and Logging）**:
   - **容错机制**：确保系统的健壮性和数据的安全性。
   - **日志记录**：记录操作日志，便于调试和故障排查。

这些模块共同构成了 LevelDB 的架构，使其成为一个灵活、高效的键值存储解决方案。


## TODO

