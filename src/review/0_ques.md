## 2.18下午字节一面70min PASS 

1．介绍一下steal no-steal force no-force策略。 mit6.830 lab6

2．如何在steal／no—force策略下实现事务回滚与崩溃恢复。mit6.830 lab6

3．浮点数的存储格式。

4．用户态与内核态的区别。CPU权限位，页表，PTE＿U权限。

5．进入内核态的方式，过程。系统调用与中断有什么区别。mit6．s081 lab trap

6．谈谈虚拟内存，单页表下虚拟内存最大可以多大。物理内存呢？页面置换算法。跟架构有关，

MAXVA 2^(3*9+12)。2^56。 FIFO LRU CLOCK...

7．介绍一下mmap，如何实现懒惰分配与处理缺页异常的。mit6．s081 lab mmap

8．synchronized与volatile区别、作用。CAS实现机 制，monitor与AQS实现机制。八股，monitor和 AQS原理近似。

9．leetcode 329．矩阵中的最长递增路径。2.21下午字节 二面 60min PASS 1．给定一个一维数组作为向量，均不为零。求该向量的非零正交向量。奇偶分别处理，取最大公因数。2．leetcode 95．不同的二叉搜索树II

3．leetcode 1751．最多可以参加的会议数目II。只写出了不怎么完善的状态转移方程。2.21下午某DB HR OC

## 2.22晚上阿里云部门A一面30min PASS

1．leetcode 11．盛最多水的容器。

2．讲讲malloc（）底层原理。mit6．s081 lab lazy。 sbrk，懒惰分配，缺页异常。

3．讲讲三握四挥。收发能力，SYN，ACK，随机选取SYN防止攻击。

4．讲讲DMA。硬件如何与内核交互。mnit6．s081 labnet

2.23下午字节 三面30min PASS 1．Raft选主流程说一下。

2．MapReduce流程说一下，是分布式的吗。3．leetcode 33．搜索旋转排序数组

## 2.24晚上阿里云部门B一面90min PASS

·压力很大被问倒次数比之前所有面试加起来翻个番还多

1．Raft分区，小分区与大分区状况描述。

2．Raft优化，learner如何实现，与follower有什么区 别。

3．小分区大任期与大分区小任期合并导致的选主期间服务不可用问题，如何优化。

4．如何热更替Raft节点

。论文有，没要求实现，所以没看。5．CPU实模式与保护模式

。没听说过。查了一下很类似于xv6没有设置satp寄存器前不经过MMU直接访问物理地址的情况，即实模式

。知道这个过程，但是不知道这两个名字。

6．进程、线程、协程。怎么实现的进程调度。switch函数保存了哪些寄存器。

7．Golang的协程怎么实现的，具体调度算法。

8．内核肯定写过汇编代码吧，知道哪些汇编指令。9．LRU缓存池设计，怎么细化锁粒度的，为什么这么设计。

10．讲一讲Xv6启动全过程。11．讲一讲自旋锁如何实现。

12．锁是如何实现公平与非公平的。13．Xv6的定时器中断如何实现。

14．讲一讲中断的上半部与下半部，举个栗子：网卡。15．如何在Xv6基础的UDP模块基础上实现TCP。

。面向连接，面向流。读写缓冲区、半连接区、连接区、对应的SYN／ACK号。

。类似ARP一样的内核级自动回复。漏答了面向连接。

16．TCP三次握手，为什么要这么设计。

。游离网络消息，可能过期。发送到服务器上，导致客户端根本没有请求建立连接却占用了服务器的半连接区。

17．B＋树索引的优点。18．讲讲LSM树。

19．讲一讲一条SQL语句的执行过程。20．对于缓存，采用数组好还是Map好？

。CPU缓存是数组：尽管是O（n），但是无空隙，有效减少缺页中断。

。看问题全面性，类比缓存池锁粒度细化，增大时间复杂度减少锁冲突。

21．场景题：设计一个分布式的注册系统。

。关注了太多模块内的底层技术细节，答得很不好。

。以模块的思路来看待整个系统，眼界要高一点。。去看看秒杀系统。

## 2.25下午阿里云部门C一面70min 可能挂

1．大体介绍一下raft算法，出现背景，解决什么问题。

2．Raft心跳介绍一下。

3． CAP BASE raft zookeeper相关的东西，介绍一 下。Zookeeper怎么处理一致性与可用性的。4．还了解其他的分布式架构吗？Spanner等。5．谈一谈inode与linux文件系统。 6．inode结构体内有什么内容？

。只答了Xv6中有的：大小、类型、硬连接引用计数、data block序号。

。面试官说还有很多内容，可以看一下ext4。之前只学习过ext2与ext3。

7．进程、线程、协程。

8．协程有什么优化？不陷入内核态，调度器协程，GMP调度算法等。

9．介绍一下读写锁原理，锁升级，锁降级。AQS那一套。

10．我明确表示不会cpp，他还硬问我const。。本科大一的时候看过Effectivec＋＋，const在前 在后含义不同，具体含义早忘了。

11．leetcode 394．字符串解码

。要比Ic原题更难，数字可有可无，且数字可以直接修饰字母，在括号或单字母后面。

。思路正确，但没AC。medium都没A，估计悬了。

## 2.25下午阿里云部门B二面60min PASS

1．聊天，聊转专业问题。

2．基础数据结构，随便说说。

3．数组和链表如何选择，读写请求多或者查询请求多。

4．快排讲一讲，时间复杂度，空间复杂度，最坏复杂度。

5．稳定吗，怎么理解稳定不稳定，可以让他稳定吗。6．谈谈树。树，二叉树，二叉搜索树，平衡二叉树，2—3树，红黑树，2—N树（B树），B＋树。

7．有没有用过B＋树结构，为什么要用。MIT 6.830LAB 5

8．讲讲B＋树的插入，删除过程。

9．讲讲读写锁，AQS，锁升级，锁降级，JUC中支持哪一个。

10．sql语句分析怎么做的。Parser自动机。11．进程、线程、协程。

12．哲学家算法怎么实现的，死锁四个条件。

。他说我死锁四个条件背的特别熟，蚌埠住了。我说我做的等待图检测其实没这么高大上，就是普通的DFS检测有向图是否存在环。

13．讲讲在linux下你是如何实现协程的。14．jvm参数，调优，用过哪些。

。没怎么用过，只是在看深入理解JVM的时候照着敲了敲。

15．进程CPU或者内存占用特别高，怎么排查问题。ojvisualvm，dump。只是知道可以这样做，但

是没有实践过，也是学JVM的时候照着敲了敲。16．raft选主流程。

17． raft与zookeeper，BASE那一套。

18．聊天，想从事哪方面的工作，介绍了一下计算的编排调度、对接虚拟化等方面。

## 2.25晚上字节 HR OC


## 字节鸡架三面

1．自我介绍

2．事务隔离级别及实现（四种都要说，答得不是很好），mvcc，低水位高水位

3．直方图，基数怎么用的？怎么获取直方图的？直接扫表太大怎么办？（等距离抽样）抽样什么时候比较准（列值重复次数比较少的时候

吧）

4．B＋树索引并发，叶子节点访问的并发问题，比如：

select* from t where id=1;

delete id<4;

一般是让线程自杀吧（15445提到过）

5.6.830项目，怎么组织page在磁盘上的布局＝》heapfile还有bitmap

6．LRU，BuffePool，LRU-K，MySQL的LRU冷热分离及目的（预读＋减少全表扫描page不命中）

7．两阶段锁

8．怎么用DP实现Join order的？

9．两表连接的算法（循环，基于块，hash join吧）

10．hash join无法全部load到内存怎么办？（sharding）

11．Raft的网络分区怎么解决的？恢复后的节点状态是怎么变化的（这块没答好．．．）

12．分布式共识算法最核心的问题（大佬人很好，给了很多提示，慢慢引导）＝＞lamport论文里的时序问题

13．java的gc机制，为什么这么做？

14．虚拟地址是什么怎么实现

15．多级页表，页表没命中咋办（我以为他问怎么分配物理内存，讲了伙伴系统和slab，发现不是．．．）＝》缺页中断＝》系统调用＝》通过中断

号中断处理程序＝》分配内存＝＞返回物理内存的指针＝》填充页表项

16．最近在看什么书？＝》linux内核设计与实现。有什么感悟？

17．去年秋招挂了字节，你怎么继续学习的？＝》多看书多总结，之前停留在教科书上，计算机基础（指计网os）还是需要深入到内核里

18．看了啥书？＝》unp apue Linux一些内核书，还有mit的xv6实验

19．算法题：leetcode53题（竟然出easy？？）

反问环节：

1．给个学习建议？＝》有自己的想法，坚持下去。多思考，知道what，更需要知道why

## 字节鸡架二面 2022年3月1日 15：51

1．在腾讯实习做了什么？（一直怼，给哥们整自闭了）

2．堆内存和栈内存

3．内存泄露，怎么解决

4．进程地址空间，共享内存

5．怎么决定是多进程还是多线程

6．多线程的线程数怎么决定？

7．linux的调度算法cfs，怎么实现的（红黑树，vruntime）

8．tcp三次握手，两次行不行

9．b＋树分裂和合并过程

10．b＋树顺序插入会导致节点利用率只有 50％，有什么优化思路

11．innodb隔离级别

12． mvcc和read view

13．优先队列底层实现，为什么不用其他树状结构而是用堆

14．k个一组反转链表 

## PolarDBX一面凉经

问 predicate pushdown，问我看过query optimization by predicate move-around这篇经典论文吗 （答：没有）然后和我讲了一下论文的大致内容。他这里问的重点完全在优化器那一块，而我工作的重点则是在存储那一块，优化器只是写了一个简单的rule（这里只能不停的说不会，淦）

添加计算负数的功能，这个应该没啥好说的，本质上就是在表达式框架内添加一个rule。

问为Values插入的数据推导类型，问我怎么推导的，pg是怎么推导的（这个不是很确定，但是大概答了一下）。然后问一些类型推导的扩展内容（不会）。

最后问了decimal的编码，这个感觉答得没有问题。

算法先是一个多线程的题，不会多线程，于是换了一个很明显的字符串匹配，但是不会写KMP，写了个暴力匹配，寄！

总结：要我说自己做过的东西没有什么问题，但是这个扩展遭不住。。。。。

面试官的建议：把写在简历上的，找论文和开源产品，系统性研究下；练习下KMP。Type '/' for commands


## 字节鸡架一面

搞MySQL存储运算分离的组。

1．介绍项目SimpleDB（6.830的lab）

2．怎么向一个完全不懂DB的人介绍你这个项目＝＝》我从SQL解析层到查询优化查询执行，还有事务索引，底层存储串起来讲了一下。

3．说说项目里的SQL解析怎么实现的？

4．你的B＋树实现的是聚簇还是非聚簇（很奇怪的问题，我就说了主键和非主键索引还有回表这些东西）

5．怎么实现事务的？ACID都是怎么对应上的？＝》2PL＋脏页落盘

6．事务隔离级别

7．你写了steal／no force，介绍一下？＝》讲了steal和force的基本概念

8．你实现了redo log和undo log，怎么实现的？＝＞日志条目格式＋checkpoint

9．B＋树支持并发吗？（蚂蚁也问过，螃蟹就完事了）

10．查询优化怎么实现的？＝》直方图，基数，多表连接代价，order join

11．你的两表连接支持走索引吗？＝》没有，是简单的嵌套join，顺便给她讲了走索引是怎么实现的，这块估计想问Hash Join吧

1．数据库的基数，选择性都是什么？直方图你怎么用的？

2．介绍BufferPool和LRU

3．写LRU（又是LRU

反问环节＋等二面

个人心得：问题不难，都答上来了。项目引申出DB内核的东西不少，比较推荐看海豚书巩固一下


## 面试

2.15下午某DB一面50min PASS 1．手写快排，时间空间最坏复杂度。

2．Raft选举投票与图8。核心是raft过半存储并不等同于commit

3．写内核怎么debug的？gdb b print backtrace frame....

4．进程调度。switch函数、调度器线程、时间片、优先级、CFS、红黑树。

5．红黑树、B＋树优劣。IO方面

6．B＋树如何组织数据，3层高容纳数据计算。指针索引指针，夹心式。

7．访问B＋树如何加锁？从根节点开始一直加锁，如果可能的删除与增加所以不能释放锁。

8．粒度为整个索引，如何优化？蟹行协议，非必要就立刻释放锁，lock转换为latch。

2.18下午字节一面70min PASS 1．介绍一下steal no-steal force no-force策略。 mit6.830 lab6

2．如何在steal／no—force策略下实现事务回滚与崩溃恢复。mit6.830 lab6

3．浮点数的存储格式。

4．用户态与内核态的区别。CPU权限位，页表，PTE＿U权限。

5．进入内核态的方式，过程。系统调用与中断有什么区别。mit6．s081 lab trap

6．谈谈虚拟内存，单页表下虚拟内存最大可以多大。物理内存呢？页面置换算法。跟架构有关，

MAXVA 2^(3*9+12)。2^56。 FIFO LRU CLOCK...

7．介绍一下mmap，如何实现懒惰分配与处理缺页异常的。mit6．s081 lab mmap

8．synchronized与volatile区别、作用。CAS实现机 制，monitor与AQS实现机制。八股，monitor和 AQS原理近似。

9．leetcode 329．矩阵中的最长递增路径。2.21下午字节 二面 60min PASS 1．给定一个一维数组作为向量，均不为零。求该向量的非零正交向量。奇偶分别处理，取最大公因数。2．leetcode 95．不同的二叉搜索树II

3．leetcode 1751．最多可以参加的会议数目II。只写出了不怎么完善的状态转移方程。2.21下午某DB HR OC

2.22晚上阿里云部门A一面30min PASS

1．leetcode 11．盛最多水的容器。

2．讲讲malloc（）底层原理。mit6．s081 lab lazy。 sbrk，懒惰分配，缺页异常。

3．讲讲三握四挥。收发能力，SYN，ACK，随机选取SYN防止攻击。

4．讲讲DMA。硬件如何与内核交互。mnit6．s081 labnet

2.23下午字节 三面30min PASS 1．Raft选主流程说一下。

2．MapReduce流程说一下，是分布式的吗。3．leetcode 33．搜索旋转排序数组

2.24晚上阿里云部门B一面90min PASS

·压力很大被问倒次数比之前所有面试加起来翻个番还多

1．Raft分区，小分区与大分区状况描述。

2．Raft优化，learner如何实现，与follower有什么区 别。

3．小分区大任期与大分区小任期合并导致的选主期间服务不可用问题，如何优化。

4．如何热更替Raft节点

。论文有，没要求实现，所以没看。5．CPU实模式与保护模式

。没听说过。查了一下很类似于xv6没有设置satp寄存器前不经过MMU直接访问物理地址的情况，即实模式

。知道这个过程，但是不知道这两个名字。

6．进程、线程、协程。怎么实现的进程调度。switch函数保存了哪些寄存器。

7．Golang的协程怎么实现的，具体调度算法。

8．内核肯定写过汇编代码吧，知道哪些汇编指令。9．LRU缓存池设计，怎么细化锁粒度的，为什么这么设计。

10．讲一讲Xv6启动全过程。11．讲一讲自旋锁如何实现。

12．锁是如何实现公平与非公平的。13．Xv6的定时器中断如何实现。

14．讲一讲中断的上半部与下半部，举个栗子：网卡。15．如何在Xv6基础的UDP模块基础上实现TCP。

。面向连接，面向流。读写缓冲区、半连接区、连接区、对应的SYN／ACK号。

。类似ARP一样的内核级自动回复。漏答了面向连接。

16．TCP三次握手，为什么要这么设计。

。游离网络消息，可能过期。发送到服务器上，导致客户端根本没有请求建立连接却占用了服务器的半连接区。

17．B＋树索引的优点。18．讲讲LSM树。

19．讲一讲一条SQL语句的执行过程。20．对于缓存，采用数组好还是Map好？

。CPU缓存是数组：尽管是O（n），但是无空隙，有效减少缺页中断。

。看问题全面性，类比缓存池锁粒度细化，增大时间复杂度减少锁冲突。

21．场景题：设计一个分布式的注册系统。

。关注了太多模块内的底层技术细节，答得很不好。

。以模块的思路来看待整个系统，眼界要高一点。。去看看秒杀系统。

2.25下午阿里云部门C一面70min 可能挂

1．大体介绍一下raft算法，出现背景，解决什么问题。

2．Raft心跳介绍一下。

3． CAP BASE raft zookeeper相关的东西，介绍一 下。Zookeeper怎么处理一致性与可用性的。4．还了解其他的分布式架构吗？Spanner等。5．谈一谈inode与linux文件系统。 6．inode结构体内有什么内容？

。只答了Xv6中有的：大小、类型、硬连接引用计数、data block序号。

。面试官说还有很多内容，可以看一下ext4。之前只学习过ext2与ext3。

7．进程、线程、协程。

8．协程有什么优化？不陷入内核态，调度器协程，GMP调度算法等。

9．介绍一下读写锁原理，锁升级，锁降级。AQS那一套。

10．我明确表示不会cpp，他还硬问我const。。本科大一的时候看过Effectivec＋＋，const在前 在后含义不同，具体含义早忘了。

11．leetcode 394．字符串解码

。要比Ic原题更难，数字可有可无，且数字可以直接修饰字母，在括号或单字母后面。

。思路正确，但没AC。medium都没A，估计悬了。

2.25下午阿里云部门B二面60min PASS

1．聊天，聊转专业问题。

2．基础数据结构，随便说说。

3．数组和链表如何选择，读写请求多或者查询请求多。

4．快排讲一讲，时间复杂度，空间复杂度，最坏复杂度。

5．稳定吗，怎么理解稳定不稳定，可以让他稳定吗。6．谈谈树。树，二叉树，二叉搜索树，平衡二叉树，2—3树，红黑树，2—N树（B树），B＋树。

7．有没有用过B＋树结构，为什么要用。MIT 6.830LAB 5

8．讲讲B＋树的插入，删除过程。

9．讲讲读写锁，AQS，锁升级，锁降级，JUC中支持哪一个。

10．sql语句分析怎么做的。Parser自动机。11．进程、线程、协程。

12．哲学家算法怎么实现的，死锁四个条件。

。他说我死锁四个条件背的特别熟，蚌埠住了。我说我做的等待图检测其实没这么高大上，就是普通的DFS检测有向图是否存在环。

13．讲讲在linux下你是如何实现协程的。14．jvm参数，调优，用过哪些。

。没怎么用过，只是在看深入理解JVM的时候照着敲了敲。

15．进程CPU或者内存占用特别高，怎么排查问题。ojvisualvm，dump。只是知道可以这样做，但

是没有实践过，也是学JVM的时候照着敲了敲。16．raft选主流程。

17． raft与zookeeper，BASE那一套。

18．聊天，想从事哪方面的工作，介绍了一下计算的编排调度、对接虚拟化等方面。

2.25晚上字节 HR OC


2022/11/06

# 书籍推荐

—首先需要了解操作系统的基本概念。这方面的研究可参考《操作系统：设计与实现》 （作者： Andrew S.Tanenbaum）这本书，该书会以 MINIX 为例讲解操作系统的概念。

—在掌握了操作系统的基本概念以后，接下来就可以开始研究Linux的机制了。在这个方面可参考《Linux内核设计与实现》 （作者：Robert Love）这本书，该书将从概念上讲解Linux 的运行机制。

—在 Linux 内核运行机制有了一定的了解之后，就可以开始具体研究 Linux 内核源码了。这方面最值得推荐的书籍是《深入理解Linux内核》 （作者： Daniel P. Bovet）这本书。在学习这本书时切记需要搭配 Linux 的内核代码一起研究，这将会是一个非常漫长，且需要一步一个脚印的过程。

—在理解了 Linux 的内核实现之后，我们就可以选择一个具体的开发方向来进行下一步深入研究了。如果想研究设备驱动程序的开发，就可以参考《Linux 设备驱动程序》（作者：Corbet J.）这本书。如果想从事网络方面的开发，则可以参考《深入理解Linux网络技术内幕》这本书。需要指出的是，如今与 Linux 内核相关的工作，大多集中在一些嵌入式开发领域。所以，我们通常还需要阅读一些介绍主流 CPU 体系架构 的的资料。例如，ARM 就看对应的芯片手册，而MIPS可以参考《see mips run》这本书（第一第二版都可以）。

除此之外，由于Linux本质上脱胎于UNIX，所以在这类系统的应用层程序开发方面，也可以选择性地阅读以下书籍：

—首先推荐的是《UNIX 环境高级编程》，如果能把该书中的示例都实践一遍，我们就会对整个 UNIX/Linux 的应用层编程有系统性的认识。

—如果条件允许，我也会建议系统性地学习一下《UNIX网络编程》（卷 1—2）这套书，这样一来，在应用层面上从事与网络应用相关的开发工作就基本上应该不会有太大的问题了。

总而言之，千万不要因为 Linux 内核的复杂性而产生畏难情绪，一步一个脚印地心无杂念地研究下去即可，研究本身就会给我们带来极大地快乐与成就感。重点是不要被当下浮躁的社会风气影响，少上社交网络，少看公众号和短视频，把时间花在有点意义的事情上。

owlman 187 DAYS / 146 MEMOS

